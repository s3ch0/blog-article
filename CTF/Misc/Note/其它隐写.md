# 非常规隐写

## 非常规隐写考点

### html 文件隐写

html 文件隐写一般就是使用 snow
snow 是一款在 html 嵌入隐写信息的软件，它的原理是通过在文本文件末尾嵌入空格和制表符的方式嵌入隐写信息，不同空格与制表位的组合代表不同的嵌入信息

在线网站 http://fog.misty.com/perry/ccs/snow/snow/snow.html 
使用 snow 工具

### NTFS 文件隐写

NTFS 数据流文件也被称为 Alternate data streams ， 简称 ADS， 是 NTFS 文件系统的一个特性之一，允许单独的数据流文件存在，同时也允许文件附着多个数据流，除了主文件流之外还允许许多非主文件流寄生在主文件流中，使用资源派生的方式来维持与文件的相关信息，并且这些寄生的数据流文件我们使用资源管理器无法看到


解决方法：
`notepad :test1.txt` 这个命令只有自己已经知道 NTFS 流文件名的时候使用，局限性很大，同时失败几率也大
利用工具 `NTFS Streams Editor`
NTFS Streams Info

```cmd
echo "flag{test}" > 1.txt:flag.txt
notepad 1.txt:flag.txt
```
winrar 不会破坏文件的结构，如果用其它压缩工具可能会破坏掉文件的结构.所以一般 NTFS 流隐写大多数都是使用 winrar 进行打包压缩的。

### pyc 隐写

[Stegosaurus](https://github.com/AngelKitty/stegosaurus) 的隐写工具，它允许我们在 Python 字节码文件 (pyc 或 pyo) 中嵌入 Payload. 由于编码密度较低，因此我们嵌入 Payload 的过程既不会改变源代码的运行行为，也不会改变源文件的文件大小

解决方法：
使用 Stegosaurus 提取密文， Stegosaurus 仅支持 Python 3.6 及其以下版本 python3 -m stegosaurus -h
http://bitbucket.org/jherron/stegosaurus/master/


uncompyle6

```bash
pip install -i \
https://mirrors.aliyu.com/pypi/simple/
uncompyle6
```
Stegosaurus 这个工具好像在 python3.6 下效果最好

### 视频隐写


MP4 格式视频隐写和 AVI 格式视频隐写，隐写方式可以是将信息隐藏到视频的每一帧中，或者利用隐写算法进行信息隐藏

+ ffmpeg, 对视频操作的神器,可以对视频进行快速分帧 `ffmpeg -i test.mp4 -r 30 image-%5d.bmp`
+ MSU VideoStego

*****题目例子**

[Buuctf 黄金6年]([RoarCTF2019]黄金6年)

```bash
ffmpeg -i 黄金6年.mp4 -r 30 image-%5d.bmp
```

### 游戏题

目前比赛经常会出游戏题，来缓解大家紧张的情绪，一般这种题目难度比较第，部分题目出题人通过修改像素点，将flag隐藏到游戏通过的位置，所以只需要通关游戏就可以拿到flag，FC游戏和PC游戏都经常出现


解决方法:
+ 安装 VirtualNES 等游戏模拟器
+ 通过二进制修改内存或者作弊器获取游戏胜利
