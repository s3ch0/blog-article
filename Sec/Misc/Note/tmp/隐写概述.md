# Misc中隐写概述
隐写术是一门关于信息隐藏的技巧与科学，所谓信息隐藏指的是 <font color='red' face=Monaco size=3>不让除预期的接受者之外的任何人知晓信息的传递事件或者信息的内容。</font>

<div style='border-radius:15px;display:block;background-color:#a8dadc;border:2px solid #aaa;margin:15px;padding:10px;'>
 隐写术的英文叫做 <code>Steganography</code>,来源于特里特米乌斯的一本讲述密码学与隐写术的著作 <code>Steganographia</code> 该书书名源于希腊语，意为 “隐秘书写”.
</div>

+ [CTF Wiki ( Misc )](https://ctf-wiki.org/misc/introduction/)



## Misc 中常见隐写题目种类
隐写术题目在 CTF 中大致分为以下几种类型:
+ 图片隐写 ( jpg,png,bmp,等图片的信息隐藏 )
+ 音频隐写 ( 如 MP3 隐写，波形隐写，频谱隐写 )
+ 文档隐写 ( 常见文档隐写格式如 doc,ppt,pdf等文件的信息隐藏 )
+ 视频隐写 ( 在嵌入视频中嵌入隐藏信息 )
+ 其它隐写 ( 如 NTFS 流，HTML的snow隐写等 )

## 文件头

在隐写题目中，首先要介绍的就是文件头

<font color='red' face=Monaco size=3>**文件头是位于文件开头的一段承担一定任务的数据.一般都在文件开头的部分.**</font> 

文件头一般是系统判断文件类型的重要标准，尤其是当我们遇到需要修复文件的题目时，更加需要掌握常见文件的头部和尾部标识


## 常用工具的安装

### 16 进制编辑器

+ 十六进制编辑器，用来以16进制视图进行文本编辑的编辑工具软件。
+ 十六进制编辑器可以用来检查和修复各种文件，恢复删除文件，硬盘损坏造成的数据丢失等，

如 `010 Editor`, `WinHex` 等都是功能比较强大的 十六进制编辑器，推荐使用 `010 Editor`，里面内置了很多模板，分析比较方便


+ [010 editor for Linux](https://www.sweetscape.com/download/010editor/download_010editor_linux64.html)
+ [010 editor for Windows]()

下面是 `010 editor` 可能有用的注册码

```
用户名:www.budingwang.com
注册码:CR96-4B9C-6470-303F

用户名:www.budingwang.com
注册码:CR71-DD9C-C1D3-55D8

用户名:www.budingwang.com
注册码:CRE7-D59C-98D4-EF4E

用户名:www.budingwang.com
注册码:CR2C-A19C-E8F5-6185

用户名:www.budingwang.com
注册码:CR5F-BA9C-6A95-9CF6
```
或者删除 `~/.config/010 Editor.ini` 这个文件一直试用。

Linux 内我们可以使用 `ghex`,`xxd`,`010editor` 来编辑文件的 16 进制

![alt](https://zhouhao-blog.oss-cn-shanghai.aliyuncs.com/blog/Misc/Note/intro_misc.assets/2022-09-25_16-12.png)

---

### file 

Linux 系统自带工具，用来快速查看文件类型

常用方式: file file_name (文件名)

### Binwalk
Binwalk 是一个自动提取文件系统，该工具最大的优点就是可以自动完成指定文件的扫描，智能发掘潜藏在文件中所有可疑的文件类型及文件系统。相比与之前介绍的 file 命令工具来说，file只是从文件第一个字节开始识别，且只能把一个文件识别成一个类型的文件，很难看出是否隐藏其它的文件，Binwalk就能很好的完成这项任务。

Binwalk 快速提取文件 `binwalk -e 文件名`


### Foremost

Foremost 是基于文件开始格式,文件结束标志和内部数据结构进行恢复文件的程序。该工具通过分析不同类型文件的头，尾和内部数据结构，同镜像文件的数据进行比对，以还原文件。它默认支持19种类型文件的恢复。用户还可以通过配置文件扩展支持其他文件类型。有时候binwalk无法正确分离出文件，这时候可以尝试使用 foremost进行分离

分离命令 `foremost 文件名`

### dd 
前面介绍的两种都是自动化分离工具,dd 这个工具是一种半自动化工具，有的时候自动化工具不能实现文件的分离，所以需要使用这个工具来手动进行分离。

分离常用命令 `dd if=源文件 bs=1 skip=开始分离的字节数 of=目标文件名`


### Stegsolve

CTF中，最常用来检测 LSB 隐写痕迹的工具是 `Stegsolve`,这是一款可以对图片进行多种操作的工具，包括对图片进行 `xor,sub` 等操作，对图片不同通道进行查看等功能

Stegsolve基本功能：
+ File Format 文件格式,这个主要是查看图片的具体信息
+ Data Extract 数据抽取,图片中隐藏数据的抽取 ( LSB MSB )
+ Frame Browser 帧浏览器,主要对GIF之类的动图进行分解
+ `Image Combiner` 拼图,图片拼接

### Stegdetect
Stegdetect 程序主要用于分析 JPEG 文件，可以检测到通过 JSteg,JPHide,OutGuess,Invisible Secrtes,F5,appendX和Camouflage 等这些隐写工具隐藏的信息，Stegdetect 通过统计测试来分析图像文件中是否包含隐藏内容。它运行静态测试以判断隐藏的内容是否存在。此外，它还尝试识别隐藏内容是通过哪个隐写工具嵌入的。

常用命令 `stegdetect -s 10.0 文件名`

10.0 代表我们使用最高级别的检测方式(0-10)


