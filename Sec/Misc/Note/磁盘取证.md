# 磁盘取证

+ FTK,DiskGenius 等硬盘读取的使用
+ 磁盘取证分析，VMDK取证分析，Linux硬盘镜像挂载与还原删除文件

## 取证概述

在 CTF 中，取证赛题包括了 <font color="red" face=Monaco size=3> 文件分析，隐写，内存镜像分析，和流量抓包分析。 </font> 任何要求检查一个静态数据文件 (与可执行程序与远程服务器不同) 从而获取隐藏信息的都可以被认为是取证题 (除非它包含了密码学知识而被认为是密码类赛题)

取证作为 CTF 中的一大类题目，不完全包括安全产业中的实际工作，常见的与之相关的工作是应急/事故响应，但即使在事故响应工作中，计算机取证也经常是执法部门获取证据数据和证物的工作，而非对防御攻击者或恢复系统感兴趣的商业事故响应企业


### AccessData FTK Imager

FTK Imager 是一款绿色免费的镜像工具，功能十分强大，支持 `E01,DD,L01,MG,VMDK,VHD,AD1` 等格式，并且可以获得当前内存镜像，获取受保护的文件，比如直接获取当前系统的注册表文件


### DiskGenius
DiskGenius 是一款专业级别的数据恢复软件，算法精湛，功能强大，用户群体广泛；支持各种情况下的文件恢复分区恢复，恢复效果好；拥有文件预览扇区编辑，加密分区恢复，Ext4 分区恢复，RAID 恢复功能

### extudelete

常见的开源恢复工具有：debugfs,R-Linux,ext3grep,extundelete
+ ext3grep 只支持 ext3 文件系统
+ extundelete 支持 ext3 和 ext4 文件系统

实现原理： 通过分析文件系统日志，解析出所有文件的 inode 信息，利用 inode 去查找所在 block, 利用 dd 备份出以删除的数据。


## 考察方式
+ E01 镜像文件加载
+ Linux 硬盘加载与文件还原
+ VMDK 文件取证分析

### E01 镜像文件加载
EnCase Image File (E01) 是 EnCase 取证软件保存的镜像文件,可通过FTK 打开，并且FTK 可以对其进行格式转换

解决方法
+ 使用 FTK 等工具加载

### Linux 硬盘加载与文件还原
使用 binwalk 分析一下文件类型，从下图可判断出这个文件应该是 Linux 的一个磁盘分区，但是上面的 flag 被删除,可以通过恢复删除文件的方式获得flag


解决方法
使用 mount 对磁盘进行挂载
使用 extundelete 恢复删除文件


### VMDK 文件取证分析

使用 DiskGenius 可以加载 VMDK 虚拟机硬盘文件,并提取文件


解决方法
使用 DiskGenius 加载
使用 7z 直接解压



