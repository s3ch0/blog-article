# 内存取证

+ 内存取证工具 Volatility
+ CTF 中的考察方式

## Volatility 简介和安装

Volatility 是开源的 Windows ,Linux, MacOS ,Android ,的内存取证分析工具,由 python 编写而成，支持命令行操作，支持各种操作系统，如 Linux, MacOS, Windows

项目地址 https://github.com/volatilityfoundation/volatility


获取镜像系统类型

在分析之前，需要先判断当前镜像的信息，分析出是哪个操作系统

volatility imageinfo -f 文件名


Volatility 查看进程

volatility -f 文件名 dump的系统版本 命令
查看进程 用 pslist

volatility -f mem.dump --profile=Win7SP1x64 pslist


获取 CMD 输入

cmdscan 获取曾经在 cmd 上输入过的内容
filescan 获得文件

volatility -f mem.dump --profile=Win7SP1x64 cmdscan


## CTF 中的考察方式
+ 获取 Administrator 账户的密码
+ 借助 Elcomsoft Forensic Disk Decryptor 破解key

### 获取管理员密码

遇到需要获取 Administrator 账户的题目，我们可以通过查询 sam 表的方式查看哈希:

列举缓存在内存中的注册表

volatility -f mem.vmem -profile=WinXPSP2x86 hivelist

获取 SYSTEM SAM 的虚拟地址，分别 0xfffff8a000024010 0xfffff8a001590010
hashdump 获取用户密码的hash 然后去cmd5 这个网站进行爆破

volatility -f mem.dump --profile=Win7SP1x64 hashdump 0xfffff8a000024010 0xfffff8a001590010


### 借助 Elcomsoft Forensic Disk Decryptor 破解key

volatility -f mem.vmem --profile=WinXPSP2x86 pslist
发现有 TrueCrypt.exe 的进程 TrueCrypt.exe 是一款加密软件，而我们可以推出，suspicion 为加密结果
我们需要从内存dump出key来


解决方法：
需要借助 Elcomsoft Forensic Disk Decryptor (Elcomsoft 硬盘取证解码器，简称为 EFDD) 软件来获取 key 和破解软件

